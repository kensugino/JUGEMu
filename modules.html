<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>jGEM packages &mdash; jGEM 0.9.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.4/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.4/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="jGEM 0.9.0 documentation" href="index.html" />
    <link rel="prev" title="Tutorial" href="quickstart.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          jGEM</a>
        <span class="navbar-text navbar-version pull-left"><b>0.9.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">jGEM packages</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">jGEM packages</a><ul>
<li><a class="reference internal" href="#module-jgem.assembler">assembler module</a></li>
<li><a class="reference internal" href="#module-jgem.annotate">annotate module</a></li>
<li><a class="reference internal" href="#module-jgem.bedtools">bedtools module</a></li>
<li><a class="reference internal" href="#module-jgem.bigwig">bigwig module</a></li>
<li><a class="reference internal" href="#module-jgem.calccov">calccov module</a></li>
<li><a class="reference internal" href="#module-jgem.collector">collector module</a></li>
<li><a class="reference internal" href="#module-jgem.convert">convert module</a></li>
<li><a class="reference internal" href="#module-jgem.evaluate">evaluate module</a></li>
<li><a class="reference internal" href="#module-jgem.filenames">filenames module</a></li>
<li><a class="reference internal" href="#module-jgem.graph">graph module</a></li>
<li><a class="reference internal" href="#module-jgem.gtfgffbed">gtfgffbed module</a></li>
<li><a class="reference internal" href="#module-jgem.merge">merge module</a></li>
<li><a class="reference internal" href="#module-jgem.trimex">trimex module</a></li>
<li><a class="reference internal" href="#module-jgem.utils">utils module</a></li>
<li><a class="reference internal" href="#module-jgem">Module contents</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="quickstart.html" title="Previous Chapter: Tutorial"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Tutorial</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/modules.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class^=highlight] pre {
    line-height: unset;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: #D84315;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    /*min-width: 11ex;*/
    min-width:10ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="section" id="module-jgem">
<span id="jgem-packages"></span><h1>jGEM packages<a class="headerlink" href="#module-jgem" title="Permalink to this headline">¶</a></h1>
<p>Copyright (c) 2015-2016 Ken Sugino</p>
<div class="section" id="module-jgem.assembler">
<span id="assembler-module"></span><h2>assembler module<a class="headerlink" href="#module-jgem.assembler" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-assembler"></span><dl class="class">
<dt id="jgem.assembler.Assembler">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">Assembler</code><span class="sig-paren">(</span><em>fnobj</em>, <em>merging=False</em>, <em>saveintermediates=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#Assembler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.Assembler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fnobj</strong> &#8211; FileNames object</li>
<li><strong>merging</strong> (<em>bool</em>) &#8211; whether merging assembled models or not (default False)</li>
<li><strong>saveintermediates</strong> (<em>bool</em>) &#8211; whether to save intermediates (default True)</li>
<li><strong>kwargs</strong> &#8211; to change any of the parameter values</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="jgem.assembler.Assembler.assemble">
<code class="descname">assemble</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#Assembler.assemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.Assembler.assemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the assembly</p>
</dd></dl>

<dl class="method">
<dt id="jgem.assembler.Assembler.check_params">
<code class="descname">check_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#Assembler.check_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.Assembler.check_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Check parameter change (if run previously) and save current parameter set.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.assembler.Assembler.save_stats">
<code class="descname">save_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#Assembler.save_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.Assembler.save_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves assemble related stats into (samplename).assemble.stats.txt.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.CALCCOV">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">CALCCOV</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#CALCCOV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.CALCCOV" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Calculate coverages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ae</strong> &#8211; exons dataframe</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SideEffects:</dt>
<dd>add column (cov) to ae dataframe</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>cov.txt.gz</li>
<li>cov.bed.gz</li>
<li>assemble.cov.txt.gz</li>
<li>assemble.exons0.covci.txt.gz</li>
<li>assemble.exons0.ci.txt.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.CALCCOV.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#CALCCOV.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.CALCCOV.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.CHECKSJSUPPORT">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">CHECKSJSUPPORT</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#CHECKSJSUPPORT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.CHECKSJSUPPORT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Check junction edges have &gt;0 coverages. Remove junctions without support.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sj</strong> &#8211; junction DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">sj: compatible junctions</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>binth: coverage threshold, default:0, (for merging: 0)</li>
<li>genome: genome version, default:mm10</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>bw*.bed.gz</li>
<li>sjst.bed.gz</li>
<li>sjed.bed.gz</li>
<li>sjst.ovl.txt.gz</li>
<li>sjed.ovl.txt.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.CHECKSJSUPPORT.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#CHECKSJSUPPORT.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.CHECKSJSUPPORT.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.CONSISTENTSJ">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">CONSISTENTSJ</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#CONSISTENTSJ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.CONSISTENTSJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Remove junctions without connections to exons</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sj</strong> &#8211; junction dataframe</li>
<li><strong>ae</strong> &#8211; exon dataframe</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">sj: modify assembler sj</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="jgem.assembler.CONSISTENTSJ.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#CONSISTENTSJ.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.CONSISTENTSJ.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.EDGEFIXER">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">EDGEFIXER</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EDGEFIXER"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EDGEFIXER" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Fix edge exons by extending.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>me</strong> &#8211; exon dataframe</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">me: exon dataframe with edge exons fixed
:edgefixer: this instance for reuse later</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>gap3: for 3&#8217; UTR extension, default 50 (merging: 1)</li>
<li>gap5: for 5&#8217; UTR extension, default 50 (merging: 1)</li>
<li>covfactor: for gap filling: if coverage of the next interval is &lt; covfactor*current cov
default 0.1</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>fixed5pr.bed.gz</li>
<li>fixed3pr.bed.gz</li>
<li>edgefixer.me.bed.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.EDGEFIXER.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EDGEFIXER.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EDGEFIXER.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EDGEFIXER.fixSEedge">
<code class="descname">fixSEedge</code><span class="sig-paren">(</span><em>me</em>, <em>targets</em>, <em>utr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EDGEFIXER.fixSEedge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EDGEFIXER.fixSEedge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EDGEFIXER.make_bindf">
<code class="descname">make_bindf</code><span class="sig-paren">(</span><em>me</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EDGEFIXER.make_bindf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EDGEFIXER.make_bindf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EDGEFIXER.process_edges">
<code class="descname">process_edges</code><span class="sig-paren">(</span><em>exons</em>, <em>bindf</em>, <em>utr</em>, <em>gap=300</em>, <em>covfactor=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EDGEFIXER.process_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EDGEFIXER.process_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EDGEFIXER.process_edges_subset">
<code class="descname">process_edges_subset</code><span class="sig-paren">(</span><em>exons</em>, <em>bindf</em>, <em>targets</em>, <em>utr</em>, <em>gap=300</em>, <em>covfactor=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EDGEFIXER.process_edges_subset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EDGEFIXER.process_edges_subset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.EdgeDetector">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">EdgeDetector</code><span class="sig-paren">(</span><em>bwname</em>, <em>sigmath=3</em>, <em>minth=0.5</em>, <em>delta=15</em>, <em>covratio=0.1</em>, <em>winsize=15</em>, <em>covth=0.005</em>, <em>smwinsize=151</em>, <em>minintsize=10</em>, <em>mimath=0.15</em>, <em>triggerth=2</em>, <em>mimath2=None</em>, <em>mincutlen=50</em>, <em>aggregateratio=0.1</em>, <em>verbose=False</em>, <em>gap=0</em>, <em>gapth=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bwname</strong> (<em>str</em>) &#8211; path to coverage bigwig file</li>
<li><strong>sigmath</strong> (<em>float</em>) &#8211; sigma threshold (default 3)</li>
<li><strong>minth</strong> (<em>float</em>) &#8211; (default 0.5)</li>
<li><strong>delta</strong> (<em>int</em>) &#8211; (default 15)</li>
<li><strong>covratio</strong> (<em>float</em>) &#8211; (default 0.1)</li>
<li><strong>winsize</strong> (<em>int</em>) &#8211; (default 15)</li>
<li><strong>covth</strong> (<em>float</em>) &#8211; (default 0.005)</li>
<li><strong>smwinsize</strong> (<em>int</em>) &#8211; (default 151)</li>
<li><strong>minintsize</strong> (<em>int</em>) &#8211; (default 10)</li>
<li><strong>mimath</strong> (<em>float</em>) &#8211; min, max threshold (default 0.15)</li>
<li><strong>triggerth</strong> (<em>float</em>) &#8211; (default 2)</li>
<li><strong>mimath2</strong> (<em>float</em>) &#8211; (default None)</li>
<li><strong>mincutlen</strong> (<em>int</em>) &#8211; (default 50)</li>
<li><strong>aggregateratio</strong> (<em>float</em>) &#8211; (default 0.1)</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; (default False)</li>
<li><strong>gap</strong> (<em>int</em>) &#8211; (default 0)</li>
<li><strong>gapth</strong> (<em>float</em>) &#8211; (default 0.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="jgem.assembler.EdgeDetector.calc_stats">
<code class="descname">calc_stats</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em>, <em>v=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.calc_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.calc_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.cutQ">
<code class="descname">cutQ</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em>, <em>v=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.cutQ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.cutQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.cutboth">
<code class="descname">cutboth</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.cutboth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.cutboth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.cutone">
<code class="descname">cutone</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em>, <em>direction</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.cutone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.cutone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.detect_low_level">
<code class="descname">detect_low_level</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.detect_low_level"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.detect_low_level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.detect_min">
<code class="descname">detect_min</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.detect_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.detect_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.detect_rise">
<code class="descname">detect_rise</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.detect_rise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.detect_rise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.detect_rise2">
<code class="descname">detect_rise2</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.detect_rise2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.detect_rise2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.detect_sharp_drops">
<code class="descname">detect_sharp_drops</code><span class="sig-paren">(</span><em>v</em>, <em>maxlen</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.detect_sharp_drops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.detect_sharp_drops" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.find">
<code class="descname">find</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em>, <em>find='both'</em>, <em>returnall=True</em>, <em>ocov=0.0</em>, <em>v=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.find" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.findpeak">
<code class="descname">findpeak</code><span class="sig-paren">(</span><em>dtmp</em>, <em>th</em>, <em>sign</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.findpeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.findpeak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.fix">
<code class="descname">fix</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em>, <em>direction</em>, <em>v=None</em>, <em>sm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.fix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.fix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.getdm">
<code class="descname">getdm</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.getdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.getdm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.getsm">
<code class="descname">getsm</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.getsm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.getsm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.plotcut">
<code class="descname">plotcut</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em>, <em>direction='+'</em>, <em>ylim=None</em>, <em>xlim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.plotcut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.plotcut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.plotone">
<code class="descname">plotone</code><span class="sig-paren">(</span><em>chrom</em>, <em>st</em>, <em>ed</em>, <em>strand='+'</em>, <em>utr='3'</em>, <em>find=None</em>, <em>ylim=None</em>, <em>xlim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.plotone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.plotone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.EdgeDetector.trim">
<code class="descname">trim</code><span class="sig-paren">(</span><em>v</em>, <em>sm</em>, <em>eds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#EdgeDetector.trim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.EdgeDetector.trim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FIND53IR">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FIND53IR</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIND53IR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIND53IR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find 5&#8217;,3&#8217; exon (cut), intron retentions and single exons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>me</strong> &#8211; exon DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">ae: exons with 5&#8217;,3&#8217; cuts, irets, and single exons.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>minsecovth: minimum single exon coverage (normalized to million alignments)
default 2 (merging: 2)</li>
<li>secovth: default SE cov threshold if not using adaptive version
default 10 (merging: 10)</li>
<li>se_gap: single exon gap fill, default 170</li>
<li>se_binth: coverage threshold for SE finding, default 0.2 (merging: 0.2)</li>
<li>se_sizeth: single exon size th, default 50 (merging: 50)</li>
<li>find53ir_covratio: cov ratio threshold for FIND53IR,
default 0.2, (merging: 0.15)</li>
<li>find53ir_covth: cov threshold for FIND53IR
default 0.6, (mergin: 0.6)</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>se.cov.tmp.txt.gz</li>
<li>se.cov.all.txt.gz</li>
<li>me.exons.bed.gz</li>
<li>bw*.bed.gz</li>
<li>gap-sub-me.bed.gz</li>
<li>assemble.exons0.txt.gz</li>
<li>assemble.exons0.bed.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.FIND53IR.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIND53IR.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIND53IR.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FIND53IR.find">
<code class="descname">find</code><span class="sig-paren">(</span><em>me</em>, <em>secovth</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIND53IR.find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIND53IR.find" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FIND53IR.process_mp">
<code class="descname">process_mp</code><span class="sig-paren">(</span><em>ci</em>, <em>me</em>, <em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIND53IR.process_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIND53IR.process_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FINDEDGES">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FINDEDGES</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDEDGES"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDEDGES" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find edge exons. (Add * to the name when cut.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>me</strong> &#8211; exon DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">me: exon dataframe with edge exons added</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>mpth: mapped% th for detecting gene boundary, default:0.95 (merging: 0.9999)</li>
<li>binth: default 0 (merging: 0)</li>
<li>gap: fill this gap to distinguish gene boundary vs. exon (fill exon but not intergenic)
default 50 (merging: 0)</li>
<li>edgesize: temporary edge exon size, default 100</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>fe.sjbb.bed.gz</li>
<li>fe.sjbb-ovl.txt.gz</li>
<li>fe.exons.bed.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.FINDEDGES.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDEDGES.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDEDGES.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FINDEDGES2">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FINDEDGES2</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDEDGES2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDEDGES2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find edges</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sj</strong> &#8211; junction DataFrame</li>
<li><strong>me</strong> &#8211; exon DataFrame</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">sj: compatible junctions
:me: exon dataframe with edge exons added</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>mpth: mapped% th for detecting gene boundary, default 0.95</li>
<li>binth: bigwig to bed threshold, default 0 (merging: 0)</li>
<li>gap: fill this gap to distinguish gene boundary vs. exon (fill exon but not intergenic), default 50 (merging: 0)</li>
<li>edgesize: temporary edge exon size, default 100</li>
<li>maxexonsize: max exon size (Ttn has ~20kbp exon), default 35000</li>
<li>cutlen: check candidate bounded exons larger than this for cutting, default 350</li>
<li>ed_sigma: edge detector sigma for threshold (larger of minth, sigma*std is used),
default 3  (merging: 5)</li>
<li>ed_minth: edge detector minth for smoothed derivative, default 0.5 (merging: 0.05)</li>
<li>ed_covratio: edge detector if cov ratio to surrounds is &lt; covratio, discard,
default 0.001 (merging: 0.05)</li>
<li>ed_window: edge detector smooth window (in bp), default 15</li>
<li>ed_covth: edge detector abs cov threshold, default 2  (merging: 2)</li>
<li>ed_smwinsize: smooth window for trimming default 151</li>
<li>ed_minintsize: window for merging peaks, default 10</li>
<li>ed_aggratio: default 0.1</li>
<li>ed_mimath: min-max ratio threshold for cut decision, default 0.15 (merging: 0.2)</li>
<li>ed_mimath2: default 0.3  (merging: 0.75)</li>
<li>ed_triggerth: for rise detection (detect rise when &gt;= max*mimath*triggerth after &lt;max*mima), default 2</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>fe2.sjbb.bed.gz</li>
<li>fe2.sjbb-ovl.txt.gz</li>
<li>fe2.me1.ci.txt.gz</li>
<li>fe2.me2p.ci.txt.gz</li>
<li>fe2.me2n.ci.txt.gz</li>
<li>fe2.sj.txt.gz</li>
<li>fe2.me.txt.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.FINDEDGES2.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDEDGES2.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDEDGES2.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDEDGES2.process_mp">
<code class="descname">process_mp</code><span class="sig-paren">(</span><em>ci</em>, <em>me</em>, <em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDEDGES2.process_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDEDGES2.process_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FINDGENES">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FINDGENES</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDGENES"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDGENES" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find genes (connected components).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sj</strong> &#8211; junction dataframe</li>
<li><strong>ae</strong> &#8211; exon (all exon = single+multi exons) dataframe</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>np: number of CPU to use, default 1</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>genegraph-*</li>
<li>genes.cache.pic</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.FINDGENES.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDGENES.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDGENES.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FINDIRETS">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FINDIRETS</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDIRETS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDIRETS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find intron retentions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sj</strong> &#8211; junction DataFrame</li>
<li><strong>me</strong> &#8211; exon DataFrame</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">me: exons with irets</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>iret_mpth: mapped% th for detecting intron retension,
default 0.98 (merging: 1)</li>
<li>iret_covth: if intron cov smaller than this, then ignore
default 0.1 (merging: 0.1)</li>
<li>iret_covratio: min cov ratio between an iret and average of surrounding exons
default 0.01 (merging: 0.1)</li>
<li>binth: default 0 (merging: 0)</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>irets.bed.gz</li>
<li>irets.exons.txt.gz</li>
<li>irets.me.cov.txt.gz</li>
<li>irets.me.bed.gz</li>
<li>irets.me.covci.txt.gz</li>
<li>irets.me.ci.txt.gz</li>
<li>sj.iret.sub.bed.gz</li>
<li>sj.iret.ci.txt.gz</li>
<li>sj.iret.covci.txt.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.FINDIRETS.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDIRETS.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDIRETS.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDIRETS.find_irets">
<code class="descname">find_irets</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>mpth=0.95</em>, <em>binth=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDIRETS.find_irets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDIRETS.find_irets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDIRETS.process_mp">
<code class="descname">process_mp</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>irets</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDIRETS.process_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDIRETS.process_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FINDSE">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FINDSE</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find single exons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>me</strong> &#8211; exon DataFrame</li>
<li><strong>edgefixer</strong> &#8211; EdgeFixer instance</li>
<li><strong>secovth</strong> &#8211; se coverage threshold</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ae: all exons
:se: single exons
:me: multi-exons</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>minsecovth: minimum single exon coverage (normalized to million alignments)
default 2 (merging: 2)</li>
<li>secovth: default SE cov threshold if not using adaptive version
default 10 (merging: 10)</li>
<li>se_gap: single exon gap fill, default 170</li>
<li>se_binth: coverage threshold for SE finding, default 0.2 (merging: 0.2)</li>
<li>se_sizeth: single exon size th, default 50 (merging: 50)</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>se.cov.tmp.txt.gz</li>
<li>se.cov.all.txt.gz</li>
<li>secov.txt.gz</li>
<li>se.bed.gz</li>
<li>exons.afterfindse.txt.gz</li>
<li>me.exons.bed.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.FINDSE.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSE.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSE.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDSE.find_se">
<code class="descname">find_se</code><span class="sig-paren">(</span><em>exons</em>, <em>covth=0.5</em>, <em>gap=50</em>, <em>binth=0</em>, <em>sizeth=200</em>, <em>override=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSE.find_se"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSE.find_se" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FINDSECOVTH">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FINDSECOVTH</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSECOVTH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSECOVTH" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find single exon coverage threshold (secovth).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>me</strong> &#8211; exon DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">secovth: threshold</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>findsecovth_useref: whether to use ref for finding secov, if not use ME
default True</li>
<li>minsecovth: minimum single exon coverage (normalized to million alignments)
default 2 (merging: 2)</li>
<li>se_gap: single exon gap fill, default 170</li>
</ul>
</dd>
<dt>Files:</dt>
<dd><ul class="first last simple">
<li>findsecovth.params.txt.gz</li>
<li>findsecovth.pdf</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>findsecovth.refex.covci.txt.gz</li>
<li>findsecovth.refex.cov.txt.gz</li>
<li>se.cov.all.txt.gz</li>
<li>irets.me.cov.txt.gz</li>
<li>me.covci.txt.gz</li>
<li>me.ci.txt.gz</li>
<li>findsecovth.gap-sub-me.bed.gz</li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="jgem.assembler.FINDSECOVTH.bins">
<code class="descname">bins</code><em class="property"> = array([ 0.5 ,  0.55,  0.6 ,  0.65,  0.7 ,  0.75,  0.8 ,  0.85,  0.9 ,         0.95,  1.  ,  1.05,  1.1 ,  1.15,  1.2 ,  1.25,  1.3 ,  1.35,         1.4 ,  1.45,  1.5 ,  1.55,  1.6 ,  1.65])</em><a class="headerlink" href="#jgem.assembler.FINDSECOVTH.bins" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDSECOVTH.calc_allsecov">
<code class="descname">calc_allsecov</code><span class="sig-paren">(</span><em>me</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSECOVTH.calc_allsecov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSECOVTH.calc_allsecov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDSECOVTH.calc_refexcov">
<code class="descname">calc_refexcov</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSECOVTH.calc_refexcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSECOVTH.calc_refexcov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDSECOVTH.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSECOVTH.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSECOVTH.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDSECOVTH.find_gamma_slope">
<code class="descname">find_gamma_slope</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSECOVTH.find_gamma_slope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSECOVTH.find_gamma_slope" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDSECOVTH.find_secovth">
<code class="descname">find_secovth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSECOVTH.find_secovth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSECOVTH.find_secovth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FINDSECOVTH.save_params">
<code class="descname">save_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FINDSECOVTH.save_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FINDSECOVTH.save_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FIXEDGES2">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FIXEDGES2</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIXEDGES2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIXEDGES2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find genes (connected components).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sj</strong> &#8211; junction dataframe</li>
<li><strong>ae</strong> &#8211; exon (all exon = single+multi exons) dataframe</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>np: number of CPU to use, default 1</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>genegraph-*</li>
<li>genes.cache.pic</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.FIXEDGES2.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIXEDGES2.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIXEDGES2.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.FIXEDGES2.process_mp">
<code class="descname">process_mp</code><span class="sig-paren">(</span><em>ex</em>, <em>find</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIXEDGES2.process_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIXEDGES2.process_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.FIXSTRAND">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">FIXSTRAND</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIXSTRAND"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIXSTRAND" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Assign strand to unstranded elements using information from connected components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sj</strong> &#8211; junction dataframe</li>
<li><strong>me</strong> &#8211; exon dataframe</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">sj: junction dataframe with strand fixed
:me: exon dataframe with strand fixed</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>useallconnected (bool): whether to use all connected components or just direct neighbors
default True</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>sj0.bed.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.FIXSTRAND.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#FIXSTRAND.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.FIXSTRAND.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.MERGEEXONS">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">MERGEEXONS</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#MERGEEXONS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.MERGEEXONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Merge overlapping exons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>me</strong> &#8211; exon DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">me: exon dataframe with merged exons</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>sjex.bed.gz</li>
<li>sjex.inte.txt.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.MERGEEXONS.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#MERGEEXONS.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.MERGEEXONS.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.REMOVEJIE">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">REMOVEJIE</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#REMOVEJIE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.REMOVEJIE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Remove Junctions In Exons. Often times exons with high coverage contain
noise junctions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sj</strong> &#8211; junction DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">sj: junction dataframe without JIE
:jie: junctions in exons</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>jie_binth: coverage threshold,  default:320</li>
<li>jie_sjth: threshold for normalized read counts,  default:mm10</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>bw*.bed.gz</li>
<li>sjsupp.bed.gz</li>
<li>jie.bw.ovl.txt.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.REMOVEJIE.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#REMOVEJIE.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.REMOVEJIE.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.SELECTSEME">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">SELECTSEME</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SELECTSEME"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SELECTSEME" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Remove noise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sj</strong> &#8211; junction dataframe</li>
<li><strong>ae</strong> &#8211; exon (all exon = single+multi exons) dataframe</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">sj: junction dataframe without spurious junctions
:ae: exon dataframe without spurious exons</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>se_sizeth2: remove SE with length smaller than this, default 200</li>
<li>np: number of CPU to use, default 1</li>
<li>me2exon_sjth: 2exon genes with splice junction support less than this will be removed
default 2</li>
<li>me2exon_sizeth: 2exon genes terminal size th ~ 2 x read length, default 200</li>
<li>me2exon_covth: 2exon genes cov th, default 10</li>
</ul>
</dd>
<dt>Files:</dt>
<dd><ul class="first last simple">
<li>sj.txt.gz</li>
<li>ex.txt.gz</li>
</ul>
</dd>
<dt>TempFiles:</dt>
<dd><ul class="first last simple">
<li>selectseme.rm.se.bed.gz</li>
<li>selectseme.rm.me.bed.gz</li>
<li>selectseme.rm.ovl.txt.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.SELECTSEME.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SELECTSEME.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SELECTSEME.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.SELECTSJ">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">SELECTSJ</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SELECTSJ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SELECTSJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Select splice junction based on ratio of junction counts within overlapping junctions.
Use ratio of unique counts and ratio of total counts (to incorporate cases where there are
only non-unique counts).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sj</strong> &#8211; junction DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">sj: selected junctions dataframe</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>selectsj_ratio: thredhold for the ratio, default:0.001</li>
</ul>
</dd>
<dt>Files:</dt>
<dd><ul class="first last simple">
<li>selectsj.bed.gz</li>
<li>selectsj.inte.txt.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.SELECTSJ.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SELECTSJ.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SELECTSJ.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.SETINFO">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">SETINFO</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SETINFO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SETINFO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Set acceptor/donor id, exon categories.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sj</strong> &#8211; junction dataframe</li>
<li><strong>ae</strong> &#8211; exon dataframe</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SideEffects:</dt>
<dd>add columns to sj, ae dataframe</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.SETINFO.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SETINFO.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SETINFO.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.SJ2EX">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">SJ2EX</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SJ2EX"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SJ2EX" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Find candidate exons from junctions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sj</strong> &#8211; junction DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">me: exons dataframe
:sj: compatible junctions</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>ureadth: threshold for junction unique counts, default:0 (0 for merging)</li>
<li>mreadth: threshold for non-unique junction counts, default:0 (0 for merging)</li>
<li>maxexonsize: maximum exon size, default:35000</li>
<li>edgesize: temporary edge exon size, default:100</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.SJ2EX.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SJ2EX.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SJ2EX.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.SUBASE">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">SUBASE</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SUBASE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SUBASE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base class of assembler modules.</p>
<dl class="method">
<dt id="jgem.assembler.SUBASE.bw2bed">
<code class="descname">bw2bed</code><span class="sig-paren">(</span><em>binth</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SUBASE.bw2bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SUBASE.bw2bed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.SUBASE.call">
<code class="descname">call</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SUBASE.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SUBASE.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.SUBASE.chroms">
<code class="descname">chroms</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SUBASE.chroms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SUBASE.chroms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.SUBASE.fillgap">
<code class="descname">fillgap</code><span class="sig-paren">(</span><em>gap</em>, <em>binfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SUBASE.fillgap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SUBASE.fillgap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.assembler.SUBASE.sjfile">
<code class="descname">sjfile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#SUBASE.sjfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.SUBASE.sjfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.WRITEGENES">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">WRITEGENES</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#WRITEGENES"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.WRITEGENES" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Write genes (and isoform) BED (and GTF) files for viewing on browsers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sj</strong> &#8211; junction dataframe</li>
<li><strong>ae</strong> &#8211; exon dataframe</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>writeiso (bool): whether to write isoforms or not, default False</li>
<li>maxisonum (int):; number of maximum isoforms to write, default 10</li>
<li>writegtf (bool): whether to write GTF file, default False</li>
</ul>
</dd>
<dt>Files:</dt>
<dd><ul class="first last simple">
<li>genes.bed.gz</li>
<li>genes.iso*.bed.gz</li>
<li>genes.gtf.gz</li>
<li>genes.iso*.gtf.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.WRITEGENES.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#WRITEGENES.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.WRITEGENES.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.assembler.WRITESJEX">
<em class="property">class </em><code class="descclassname">jgem.assembler.</code><code class="descname">WRITESJEX</code><span class="sig-paren">(</span><em>asm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#WRITESJEX"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.WRITESJEX" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.assembler.SUBASE" title="jgem.assembler.SUBASE"><code class="xref py py-class docutils literal"><span class="pre">jgem.assembler.SUBASE</span></code></a></p>
<p>Write sj, ex and ci files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sj</strong> &#8211; junction dataframe</li>
<li><strong>ae</strong> &#8211; exon dataframe</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Related Parameters:</dt>
<dd><ul class="first last simple">
<li>findsecovth (bool): whether secovth is found from data</li>
</ul>
</dd>
<dt>Files:</dt>
<dd><ul class="first last simple">
<li>sj.txt.gz</li>
<li>ex.txt.gz</li>
<li>ci.txt.gz</li>
<li>sj.bed.gz</li>
<li>ex.bed.gz</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.assembler.WRITESJEX.call">
<code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#WRITESJEX.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.WRITESJEX.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="jgem.assembler.cutedges_m">
<code class="descclassname">jgem.assembler.</code><code class="descname">cutedges_m</code><span class="sig-paren">(</span><em>ci</em>, <em>me</em>, <em>bwname</em>, <em>pr</em>, <em>chrom</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#cutedges_m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.cutedges_m" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.assembler.findirets">
<code class="descclassname">jgem.assembler.</code><code class="descname">findirets</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>irets</em>, <em>chrom</em>, <em>covratio</em>, <em>covth</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#findirets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.findirets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.assembler.fixedge">
<code class="descclassname">jgem.assembler.</code><code class="descname">fixedge</code><span class="sig-paren">(</span><em>posarr</em>, <em>exs</em>, <em>strand</em>, <em>gap</em>, <em>utr</em>, <em>ignorefirstdonors</em>, <em>covfactor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#fixedge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.fixedge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.assembler.fixedge2">
<code class="descclassname">jgem.assembler.</code><code class="descname">fixedge2</code><span class="sig-paren">(</span><em>ex</em>, <em>find</em>, <em>params</em>, <em>chrom</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#fixedge2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.fixedge2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.assembler.fixedges_m">
<code class="descclassname">jgem.assembler.</code><code class="descname">fixedges_m</code><span class="sig-paren">(</span><em>ci</em>, <em>me</em>, <em>bwname</em>, <em>pr</em>, <em>chrom</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/assembler.html#fixedges_m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.assembler.fixedges_m" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="jgem.assembler.klass">
<code class="descclassname">jgem.assembler.</code><code class="descname">klass</code><a class="headerlink" href="#jgem.assembler.klass" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">FIXEDGES2</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-jgem.annotate">
<span id="annotate-module"></span><h2>annotate module<a class="headerlink" href="#module-jgem.annotate" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-compare"></span><dl class="class">
<dt id="jgem.annotate.Comparator">
<em class="property">class </em><code class="descclassname">jgem.annotate.</code><code class="descname">Comparator</code><span class="sig-paren">(</span><em>cn_ref</em>, <em>cn_tgt</em>, <em>gnamecol='gene_name'</em>, <em>gidxcol='gene_id'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#Comparator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.Comparator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Compare to reference and annotate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cn_ref</strong> &#8211; Reference ComparatorNames object</li>
<li><strong>cn_tgt</strong> &#8211; Target ComparatorNames object</li>
<li><strong>gnamecol</strong> &#8211; name of the column containing gene names (gene_name for Gencode, symbol for RefSeq)
(default gene_name)</li>
<li><strong>gidxcol</strong> &#8211; name of the column containing gene id (gene_id for Gencode,
_gidx if using connected components as genes)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="jgem.annotate.Comparator.annotate">
<code class="descname">annotate</code><span class="sig-paren">(</span><em>overwrite=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#Comparator.annotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.Comparator.annotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotate target by overlaps to reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>overwrite</strong> (<em>bool</em>) &#8211; overwrite original sj,ex files (default True)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jgem.annotate.Comparator.assign_antisense">
<code class="descname">assign_antisense</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#Comparator.assign_antisense"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.Comparator.assign_antisense" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether exons overlap in anti-sense direction.
Assign code (ex_as_ovl_(refcode)) to exon-wise and then gene-wise (gene_as_ovl_(refcode)).</p>
</dd></dl>

<dl class="method">
<dt id="jgem.annotate.Comparator.assign_intergenic">
<code class="descname">assign_intergenic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#Comparator.assign_intergenic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.Comparator.assign_intergenic" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether gene is intergenic or not</p>
</dd></dl>

<dl class="method">
<dt id="jgem.annotate.Comparator.assign_tcode_ex">
<code class="descname">assign_tcode_ex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#Comparator.assign_tcode_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.Comparator.assign_tcode_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.annotate.Comparator.assign_tcode_gene">
<code class="descname">assign_tcode_gene</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#Comparator.assign_tcode_gene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.Comparator.assign_tcode_gene" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.annotate.Comparator.assign_tcode_sj">
<code class="descname">assign_tcode_sj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#Comparator.assign_tcode_sj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.Comparator.assign_tcode_sj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.annotate.Comparator.calc_overlaps">
<code class="descname">calc_overlaps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#Comparator.calc_overlaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.Comparator.calc_overlaps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.annotate.ComparatorNames">
<em class="property">class </em><code class="descclassname">jgem.annotate.</code><code class="descname">ComparatorNames</code><span class="sig-paren">(</span><em>sjexbase</em>, <em>code</em>, <em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/annotate.html#ComparatorNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.annotate.ComparatorNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.evaluate.EvalNames" title="jgem.evaluate.EvalNames"><code class="xref py py-class docutils literal"><span class="pre">jgem.evaluate.EvalNames</span></code></a></p>
<p>Filename manager for evaluation process. Same as EvalNames</p>
<dl class="attribute">
<dt id="compare.ComparatorNames.sjexbase">
<code class="descname">sjexbase</code><a class="headerlink" href="#compare.ComparatorNames.sjexbase" title="Permalink to this definition">¶</a></dt>
<dd><p>path prefix to junction, exon files (*.sj.txt.gz and *.ex.txt.gz)</p>
</dd></dl>

<dl class="attribute">
<dt id="compare.ComparatorNames.code">
<code class="descname">code</code><a class="headerlink" href="#compare.ComparatorNames.code" title="Permalink to this definition">¶</a></dt>
<dd><p>assembly identifier</p>
</dd></dl>

<dl class="attribute">
<dt id="compare.ComparatorNames.outdir">
<code class="descname">outdir</code><a class="headerlink" href="#compare.ComparatorNames.outdir" title="Permalink to this definition">¶</a></dt>
<dd><p>output directory</p>
</dd></dl>

<p>All outputs and temporary files are prefixed by <strong>outdir/code</strong></p>
</dd></dl>

</div>
<div class="section" id="module-jgem.bedtools">
<span id="bedtools-module"></span><h2>bedtools module<a class="headerlink" href="#module-jgem.bedtools" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-bedtools"></span><dl class="function">
<dt id="jgem.bedtools.bam2bed">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bam2bed</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bam2bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bam2bed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bam2bed12">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bam2bed12</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bam2bed12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bam2bed12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bam2bw">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bam2bw</code><span class="sig-paren">(</span><em>bampath</em>, <em>chromsizes</em>, <em>bwpath</em>, <em>scale=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bam2bw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bam2bw" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate bigwig coverage from BAM.</p>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bam2wig">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bam2wig</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bam2wig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bam2wig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bed12ToBed6">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bed12ToBed6</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bed12ToBed6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bed12ToBed6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bed12_bed6">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bed12_bed6</code><span class="sig-paren">(</span><em>bed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bed12_bed6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bed12_bed6" title="Permalink to this definition">¶</a></dt>
<dd><p>convert BED12 to BED6 uses cython helper</p>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bed2bw">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bed2bw</code><span class="sig-paren">(</span><em>bedpath</em>, <em>chromsizes</em>, <em>bwpath</em>, <em>scale=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bed2bw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bed2bw" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate bigwig coverage from BED.</p>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bed2wig">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bed2wig</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bed2wig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bed2wig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bedtoolcomplement">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bedtoolcomplement</code><span class="sig-paren">(</span><em>aname</em>, <em>cname</em>, <em>chromsizes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bedtoolcomplement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bedtoolcomplement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bedtoolintersect">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bedtoolintersect</code><span class="sig-paren">(</span><em>aname</em>, <em>bname</em>, <em>cname</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bedtoolintersect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bedtoolintersect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bedtoolmerge">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bedtoolmerge</code><span class="sig-paren">(</span><em>aname</em>, <em>cname</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bedtoolmerge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bedtoolmerge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.bedtoolsubtract">
<code class="descclassname">jgem.bedtools.</code><code class="descname">bedtoolsubtract</code><span class="sig-paren">(</span><em>aname</em>, <em>bname</em>, <em>cname</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#bedtoolsubtract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.bedtoolsubtract" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.calc_ovlratio">
<code class="descclassname">jgem.bedtools.</code><code class="descname">calc_ovlratio</code><span class="sig-paren">(</span><em>aname, bname, tname, nacol, nbcol, idcol=['chr', 'st', 'ed']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#calc_ovlratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.calc_ovlratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate overlapped portion of b onto a.
Will check existence of result file (tname) and uses it if newer than input files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>aname</strong> (<em>str</em>) &#8211; bed file name 1</li>
<li><strong>bname</strong> (<em>str</em>) &#8211; bed file name 2</li>
<li><strong>tname</strong> (<em>str</em>) &#8211; result file name</li>
<li><strong>nacol</strong> (<em>int</em>) &#8211; number of columns in file 1</li>
<li><strong>nbcol</strong> (<em>int</em>) &#8211; number of columns in file 2</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Optional:</dt>
<dd>idcol (list of str): columns which specify unique entry</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A Pandas DataFrame which contains overlap info</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.compressQ">
<code class="descclassname">jgem.bedtools.</code><code class="descname">compressQ</code><span class="sig-paren">(</span><em>outname</em>, <em>noerr=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#compressQ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.compressQ" title="Permalink to this definition">¶</a></dt>
<dd><p>decorator for checking file compression and error</p>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.fillgap">
<code class="descclassname">jgem.bedtools.</code><code class="descname">fillgap</code><span class="sig-paren">(</span><em>binfile</em>, <em>gapfile</em>, <em>gap=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#fillgap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.fillgap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.get_total_bp">
<code class="descclassname">jgem.bedtools.</code><code class="descname">get_total_bp</code><span class="sig-paren">(</span><em>beddf</em>, <em>returndics=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#get_total_bp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.get_total_bp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total mapped base pairs (totbp) and covered base pairs (covbp).
The ratio totbp/covbp gives average coverage.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>beddf</strong> &#8211; a BED dataframe (a standard non BED12 format)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">total base pairs in BED
covbp: covered base pairs</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">totbp</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.get_total_bp_bedfile">
<code class="descclassname">jgem.bedtools.</code><code class="descname">get_total_bp_bedfile</code><span class="sig-paren">(</span><em>bedpath</em>, <em>bed12=False</em>, <em>chroms=None</em>, <em>returndics=False</em>, <em>checkuniq=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#get_total_bp_bedfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.get_total_bp_bedfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total mapped base pairs (totbp) and covered base pairs (covbp).
The ratio totbp/covbp gives average coverage. Process without reading entire data
into the RAM. Process non BED12 file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bedpath</strong> (<em>str</em>) &#8211; a path to BED file</li>
<li><strong>bed12</strong> (<em>bool</em>) &#8211; whether format is BED12 (default False)</li>
<li><strong>chroms</strong> (<em>list</em>) &#8211; chromosomes to consider, if None (default) use all</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">total base pairs in BED
covbp: covered base pairs</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">totbp</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.logerr">
<code class="descclassname">jgem.bedtools.</code><code class="descname">logerr</code><span class="sig-paren">(</span><em>noerr=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#logerr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.logerr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.make_bw_from_bam">
<code class="descclassname">jgem.bedtools.</code><code class="descname">make_bw_from_bam</code><span class="sig-paren">(</span><em>bampath</em>, <em>chromsizes</em>, <em>bedpath</em>, <em>bwpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#make_bw_from_bam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.make_bw_from_bam" title="Permalink to this definition">¶</a></dt>
<dd><p>convert BAM to BIGWIG, normalize average coverage to 1</p>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.make_bw_from_bed">
<code class="descclassname">jgem.bedtools.</code><code class="descname">make_bw_from_bed</code><span class="sig-paren">(</span><em>bedpath</em>, <em>chromsizes</em>, <em>bwpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#make_bw_from_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.make_bw_from_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>convert BED to BIGWIG, normalize average coverage to 1</p>
</dd></dl>

<dl class="function">
<dt id="jgem.bedtools.read_ovl">
<code class="descclassname">jgem.bedtools.</code><code class="descname">read_ovl</code><span class="sig-paren">(</span><em>c</em>, <em>acols</em>, <em>bcols=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#read_ovl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.read_ovl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.save_bed_covstats">
<code class="descclassname">jgem.bedtools.</code><code class="descname">save_bed_covstats</code><span class="sig-paren">(</span><em>bedpath</em>, <em>dstpath</em>, <em>bed12=False</em>, <em>checkuniq=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#save_bed_covstats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.save_bed_covstats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bedtools.wig2bw">
<code class="descclassname">jgem.bedtools.</code><code class="descname">wig2bw</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bedtools.html#wig2bw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bedtools.wig2bw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jgem.bigwig">
<span id="bigwig-module"></span><h2>bigwig module<a class="headerlink" href="#module-jgem.bigwig" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-bigwig"></span><dl class="function">
<dt id="jgem.bigwig.apply_threshold">
<code class="descclassname">jgem.bigwig.</code><code class="descname">apply_threshold</code><span class="sig-paren">(</span><em>infile</em>, <em>threshold</em>, <em>chroms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#apply_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.apply_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Only returns intervals exceeding the threshold</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>infile</strong> &#8211; path to bigwig</li>
<li><strong>threshold</strong> &#8211; positive float</li>
<li><strong>chroms</strong> &#8211; list of chromosome names</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">intervals (chr,st,ed)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.bigwig.bam2bw">
<code class="descclassname">jgem.bigwig.</code><code class="descname">bam2bw</code><span class="sig-paren">(</span><em>fpath</em>, <em>chromsizes</em>, <em>bpath</em>, <em>aligned=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#bam2bw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.bam2bw" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate normalized coverage from BAM</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fpath</strong> (<em>str</em>) &#8211; path to BAM</li>
<li><strong>chromsizes</strong> (<em>str</em>) &#8211; path to chromsizes file</li>
<li><strong>bpath</strong> (<em>str</em>) &#8211; path to BIGWIG</li>
<li><strong>aligned</strong> (<em>int</em>) &#8211; number of aligned reads, if None uses samtools to find it from BAM</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Requires Bedtools (genomeCoverageBed) and Kent Tool (wigToBigWig)</p>
</dd></dl>

<dl class="function">
<dt id="jgem.bigwig.block_iter">
<code class="descclassname">jgem.bigwig.</code><code class="descname">block_iter</code><span class="sig-paren">(</span><em>infile</em>, <em>chrom</em>, <em>chunk=10000000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#block_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.block_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>BigWig file iterator</p>
</dd></dl>

<dl class="function">
<dt id="jgem.bigwig.bw2bed">
<code class="descclassname">jgem.bigwig.</code><code class="descname">bw2bed</code><span class="sig-paren">(</span><em>bwfile</em>, <em>bedfile</em>, <em>chroms</em>, <em>th</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#bw2bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.bw2bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform BigWig genomeCov to binary BED by thresholding.
Makes result file (bwfile[:-3]+&#8217;.binary%g.bed&#8217;.format(th))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bwfile</strong> &#8211; path to BigWig file</li>
<li><strong>chroms</strong> &#8211; list of chromosome names</li>
<li><strong>th</strong> &#8211; coverage threshold</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">path to generated BED file</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.bigwig.cnt_bam">
<code class="descclassname">jgem.bigwig.</code><code class="descname">cnt_bam</code><span class="sig-paren">(</span><em>fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#cnt_bam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.cnt_bam" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses samtools to count reads in BAM file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fpath</strong> (<em>str</em>) &#8211; path to BAM file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">int. The number of aligned reads.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">RuntimeError</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.bigwig.get_bigwig_as_array">
<code class="descclassname">jgem.bigwig.</code><code class="descname">get_bigwig_as_array</code><span class="sig-paren">(</span><em>bwfile</em>, <em>chrom</em>, <em>st</em>, <em>ed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#get_bigwig_as_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.get_bigwig_as_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Get BIGWIG coverage values as array of size (ed-st). Array start corresponds to st.
0-based</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bwfile</strong> &#8211; path to BIGWIG</li>
<li><strong>chrom</strong> (<em>str</em>) &#8211; chromosome name</li>
<li><strong>st</strong> (<em>int</em>) &#8211; start position</li>
<li><strong>ed</strong> (<em>int</em>) &#8211; end position</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Numpy array of size (ed-st)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.bigwig.merge_bigwigs_chr">
<code class="descclassname">jgem.bigwig.</code><code class="descname">merge_bigwigs_chr</code><span class="sig-paren">(</span><em>bwfiles</em>, <em>chrom</em>, <em>chromsize</em>, <em>dstpath</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#merge_bigwigs_chr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.merge_bigwigs_chr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bigwig.merge_bigwigs_mp">
<code class="descclassname">jgem.bigwig.</code><code class="descname">merge_bigwigs_mp</code><span class="sig-paren">(</span><em>bwfiles</em>, <em>genome</em>, <em>dstpath</em>, <em>scale=None</em>, <em>np=7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#merge_bigwigs_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.merge_bigwigs_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.bigwig.wig2bw">
<code class="descclassname">jgem.bigwig.</code><code class="descname">wig2bw</code><span class="sig-paren">(</span><em>wigpath</em>, <em>chromsizes</em>, <em>bwpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/bigwig.html#wig2bw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.bigwig.wig2bw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jgem.calccov">
<span id="calccov-module"></span><h2>calccov module<a class="headerlink" href="#module-jgem.calccov" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-calccov"></span><dl class="function">
<dt id="jgem.calccov.calc_cov_chrom">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_cov_chrom</code><span class="sig-paren">(</span><em>c</em>, <em>b_iter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_cov_chrom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_cov_chrom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_cov_mp">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_cov_mp</code><span class="sig-paren">(</span><em>bed</em>, <em>bwname</em>, <em>fname</em>, <em>np</em>, <em>which='cov'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_cov_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_cov_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_cov_ovl_mp">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_cov_ovl_mp</code><span class="sig-paren">(</span><em>srcname</em>, <em>bwname</em>, <em>dstname</em>, <em>np=1</em>, <em>covciname=None</em>, <em>ciname=None</em>, <em>colname='cov'</em>, <em>override=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_cov_ovl_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_cov_ovl_mp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate coverage (from BigWig) over intervals (from srcname).
A column (default &#8216;cov&#8217;) which contains coverages is added to source dataframe
and the source is overwritten.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>srcname</strong> &#8211; path to exons tsv</li>
<li><strong>bwname</strong> &#8211; path to bigwig</li>
<li><strong>dstname</strong> &#8211; path for result</li>
<li><strong>np</strong> &#8211; number of processors</li>
<li><strong>covciname</strong> &#8211; path to covci (coverage for chopped interval dataframe)</li>
<li><strong>ciname</strong> &#8211; path to ci (chopped interval dataframe)</li>
<li><strong>colname</strong> &#8211; name for column which contain calculated coverages</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">source dataframe with column (cov) added</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SideEffects:</dt>
<dd>source tsv is overwritten with new column added</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_ecov">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_ecov</code><span class="sig-paren">(</span><em>expath</em>, <em>cipath</em>, <em>bwpath</em>, <em>dstprefix</em>, <em>override=False</em>, <em>np=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_ecov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_ecov" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate exon coverages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expath</strong> &#8211; merged ex</li>
<li><strong>cipath</strong> &#8211; chopped interval for ex</li>
<li><strong>bwpath</strong> &#8211; bigwig file (sample)</li>
<li><strong>dstprefix</strong> &#8211; prefix for outputs</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Outputs:</dt>
<dd><ol class="first last arabic simple">
<li>dstprefix+&#8217;.covci.txt.gz&#8217;: coverage for ci</li>
<li>dstprefix+&#8217;.ecov.txt.gz&#8217; : DataFrame(cols: eid, chr, st, ed, ecov)</li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_ecov_chrom">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_ecov_chrom</code><span class="sig-paren">(</span><em>covci</em>, <em>blocksize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_ecov_chrom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_ecov_chrom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_ecov_mp">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_ecov_mp</code><span class="sig-paren">(</span><em>covci</em>, <em>fname</em>, <em>np</em>, <em>blocksize=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_ecov_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_ecov_mp" title="Permalink to this definition">¶</a></dt>
<dd><p>WARNING: this assumes _id is assinged according to sorted (chr,st,ed)</p>
</dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_gcov">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_gcov</code><span class="sig-paren">(</span><em>expath</em>, <em>cipath</em>, <em>bwpath</em>, <em>dstprefix</em>, <em>override=False</em>, <em>np=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_gcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_gcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate gene coverages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expath</strong> &#8211; merged ex</li>
<li><strong>cipath</strong> &#8211; chopped interval for ex</li>
<li><strong>bwpath</strong> &#8211; bigwig file (sample)</li>
<li><strong>dstprefix</strong> &#8211; prefix for outputs</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Outputs:</dt>
<dd><ol class="first last arabic">
<li><p class="first">dstprefix+&#8217;.covci.txt.gz&#8217;</p>
</li>
<li><dl class="first docutils">
<dt>dstprefix+&#8217;.gcov.txt.gz&#8217;</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">DataFrame(col:_gidx,len,val,gcov,len2,gcov2,cids)</span><dd><p class="first last">len2: calculate length from ci with cov &gt; 0
(normal length = use entire ci&#8217;s belonging to the gene)
gcov2 = val/len2
cids: cid with cov &gt; for the gene &#8216;,&#8217;.joined</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_glen">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_glen</code><span class="sig-paren">(</span><em>ex</em>, <em>cipath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_glen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_glen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_max_chrom">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_max_chrom</code><span class="sig-paren">(</span><em>c</em>, <em>b_iter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_max_chrom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_max_chrom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.calccov.calc_sjcnt">
<code class="descclassname">jgem.calccov.</code><code class="descname">calc_sjcnt</code><span class="sig-paren">(</span><em>sjpath1</em>, <em>sjpath2</em>, <em>dstprefix</em>, <em>override=False</em>, <em>np=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#calc_sjcnt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.calc_sjcnt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.calccov.mp_worker">
<code class="descclassname">jgem.calccov.</code><code class="descname">mp_worker</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#mp_worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.mp_worker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.calccov.worker_cov">
<code class="descclassname">jgem.calccov.</code><code class="descname">worker_cov</code><span class="sig-paren">(</span><em>c</em>, <em>bwname</em>, <em>chrom</em>, <em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#worker_cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.worker_cov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.calccov.worker_max">
<code class="descclassname">jgem.calccov.</code><code class="descname">worker_max</code><span class="sig-paren">(</span><em>c</em>, <em>bwname</em>, <em>chrom</em>, <em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/calccov.html#worker_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.calccov.worker_max" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jgem.collector">
<span id="collector-module"></span><h2>collector module<a class="headerlink" href="#module-jgem.collector" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-collector"></span><dl class="class">
<dt id="jgem.collector.Collector">
<em class="property">class </em><code class="descclassname">jgem.collector.</code><code class="descname">Collector</code><span class="sig-paren">(</span><em>assemblycode</em>, <em>assemblyprefix</em>, <em>samplecode</em>, <em>sampleinfo</em>, <em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Calculate and collect coverages for all samples against specified assembly.
For large datasets, calculations of gcov/ecov/gcov1000 should be done separately
using a cluster of computers. T</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>assemblyprefix</strong> &#8211; assembly prefix path (+.ex.txt.gz,.sj.txt.gz)</li>
<li><strong>assemblycode</strong> &#8211; identifier for the assembly</li>
<li><strong>sampleinfo</strong> &#8211; dataframe containing sample info (required fileds= name, bwfile, sjfile)</li>
<li><strong>samplecode</strong> &#8211; identidier for the sample set</li>
<li><strong>outdir</strong> &#8211; output directory</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SampleInfo DataFrame columns:</dt>
<dd><ul class="first simple">
<li>name: sample name</li>
<li>bw_path: bigwig path</li>
<li>sjbed_path: sjbed path</li>
</ul>
<dl class="last docutils">
<dt>Methods:</dt>
<dd><ol class="first last arabic simple">
<li>collect_gcov: gene coverages (row:genes, col:samples)</li>
<li>collect_ecov: exon coverages (row:exons, col:samples)</li>
<li>collect_jcnt: junction counts (row:junctions, col:samples)</li>
<li>collect_gcov1000 (using trimmed model)</li>
</ol>
</dd>
</dl>
</dd>
<dt>Outputs:</dt>
<dd><p class="first">are written in files:
* 1. outdir/assemblycode.samplecode.gcov.txt.gz
* 1b. outdir/assemblycode.samplecode.ugcov.txt.gz
* 2. outdir/assemblycode.samplecode.ecov.txt.gz
* 2b. outdir/assemblycode.samplecode.uecov.txt.gz
* 3. outdir/assemblycode.samplecode.jcnt.txt.gz
* 4. outdir/assemblycode.samplecode.t1000gcov.txt.gz
* 4b. outdir/assemblycode.samplecode.ut1000gcov.txt.gz</p>
<p class="last">Individual sample gcov/ecov/gcov1000 should have filename
outdir/assemblycode.samplename.gcov.txt.gz etc.
If these files are generated by separate cluster computation,
this object will skip computation and just collect results.</p>
</dd>
</dl>
<dl class="method">
<dt id="jgem.collector.Collector.collect_all">
<code class="descname">collect_all</code><span class="sig-paren">(</span><em>np=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.collect_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.collect_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.collect_ecov">
<code class="descname">collect_ecov</code><span class="sig-paren">(</span><em>unique=False</em>, <em>np=4</em>, <em>iparallel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.collect_ecov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.collect_ecov" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect/calculate exon coverages.</p>
<p>If unique=True uses bigwig file with .uniq.bw suffix instead of .bw.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.collect_gcov">
<code class="descname">collect_gcov</code><span class="sig-paren">(</span><em>unique=False</em>, <em>np=4</em>, <em>iparallel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.collect_gcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.collect_gcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect/calculate gene coverages.</p>
<p>If unique=True uses bigwig file with .uniq.bw suffix instead of .bw.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.collect_gcov1000">
<code class="descname">collect_gcov1000</code><span class="sig-paren">(</span><em>unique=True</em>, <em>np=4</em>, <em>iparallel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.collect_gcov1000"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.collect_gcov1000" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect/calculate gene coverages. Uses trimmed model (1000bp from 3&#8217;end)</p>
<p>If unique=True uses bigwig file with .uniq.bw suffix instead of .bw.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.collect_gcov_length">
<code class="descname">collect_gcov_length</code><span class="sig-paren">(</span><em>unique=True</em>, <em>length=1000</em>, <em>np=4</em>, <em>iparallel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.collect_gcov_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.collect_gcov_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect/calculate gene coverages. Uses trimmed model (1000bp from 3&#8217;end)</p>
<p>If unique=True uses bigwig file with .uniq.bw suffix instead of .bw.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.collect_jcnt">
<code class="descname">collect_jcnt</code><span class="sig-paren">(</span><em>which='jcnt'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.collect_jcnt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.collect_jcnt" title="Permalink to this definition">¶</a></dt>
<dd><p>which = ucnt, mcnt, jcnt(=ucnt or mcnt)</p>
</dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.collect_unique">
<code class="descname">collect_unique</code><span class="sig-paren">(</span><em>np=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.collect_unique"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.collect_unique" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.ex">
<code class="descname">ex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.ex" title="Permalink to this definition">¶</a></dt>
<dd><p>assembly ex dataframe</p>
</dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.sj">
<code class="descname">sj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.sj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.sj" title="Permalink to this definition">¶</a></dt>
<dd><p>assembly sj dataframe</p>
</dd></dl>

<dl class="method">
<dt id="jgem.collector.Collector.trimex">
<code class="descname">trimex</code><span class="sig-paren">(</span><em>length</em>, <em>np=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#Collector.trimex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.Collector.trimex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.collector.CollectorNames">
<em class="property">class </em><code class="descclassname">jgem.collector.</code><code class="descname">CollectorNames</code><span class="sig-paren">(</span><em>samplecode</em>, <em>sampleinfo</em>, <em>assemblycode</em>, <em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#CollectorNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.CollectorNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.filenames.FileNamesBase" title="jgem.filenames.FileNamesBase"><code class="xref py py-class docutils literal"><span class="pre">jgem.filenames.FileNamesBase</span></code></a></p>
<dl class="method">
<dt id="jgem.collector.CollectorNames.txtname1">
<code class="descname">txtname1</code><span class="sig-paren">(</span><em>kind</em>, <em>category='output'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#CollectorNames.txtname1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.CollectorNames.txtname1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.collector.CollectorNames.txtname2">
<code class="descname">txtname2</code><span class="sig-paren">(</span><em>scode</em>, <em>kind</em>, <em>category='output'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/collector.html#CollectorNames.txtname2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.collector.CollectorNames.txtname2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jgem.convert">
<span id="convert-module"></span><h2>convert module<a class="headerlink" href="#module-jgem.convert" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-convert"></span><dl class="class">
<dt id="jgem.convert.BEDWriter">
<em class="property">class </em><code class="descclassname">jgem.convert.</code><code class="descname">BEDWriter</code><span class="sig-paren">(</span><em>mg</em>, <em>se=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="jgem.convert.BEDWriter.gen_all">
<code class="descname">gen_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter.gen_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter.gen_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.BEDWriter.gen_iso_all">
<code class="descname">gen_iso_all</code><span class="sig-paren">(</span><em>maxisonum=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter.gen_iso_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter.gen_iso_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.BEDWriter.gen_iso_gene">
<code class="descname">gen_iso_gene</code><span class="sig-paren">(</span><em>mg</em>, <em>ids</em>, <em>gid</em>, <em>maxisonum=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter.gen_iso_gene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter.gen_iso_gene" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.BEDWriter.gen_one_gene">
<code class="descname">gen_one_gene</code><span class="sig-paren">(</span><em>mg</em>, <em>ids</em>, <em>gid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter.gen_one_gene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter.gen_one_gene" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.BEDWriter.gen_subpath">
<code class="descname">gen_subpath</code><span class="sig-paren">(</span><em>mg</em>, <em>starts</em>, <em>maxisonum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter.gen_subpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter.gen_subpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.BEDWriter.path2rec">
<code class="descname">path2rec</code><span class="sig-paren">(</span><em>exons</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter.path2rec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter.path2rec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.BEDWriter.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter.write" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.BEDWriter.write_iso">
<code class="descname">write_iso</code><span class="sig-paren">(</span><em>fname</em>, <em>maxisonum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#BEDWriter.write_iso"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.BEDWriter.write_iso" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.convert.GTF2SJEX">
<em class="property">class </em><code class="descclassname">jgem.convert.</code><code class="descname">GTF2SJEX</code><span class="sig-paren">(</span><em>gtfpath</em>, <em>outdir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Convenience class for making sj (junction), ex (exon), ci (chopped interval) from GTF.</p>
<dl class="method">
<dt id="jgem.convert.GTF2SJEX.ci">
<code class="descname">ci</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.ci" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTF2SJEX.cipath">
<code class="descname">cipath</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.cipath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.cipath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTF2SJEX.ex">
<code class="descname">ex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTF2SJEX.exists">
<code class="descname">exists</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.exists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTF2SJEX.fname">
<code class="descname">fname</code><span class="sig-paren">(</span><em>suffix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.fname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.fname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTF2SJEX.make_sjex">
<code class="descname">make_sjex</code><span class="sig-paren">(</span><em>np=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.make_sjex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.make_sjex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTF2SJEX.sj">
<code class="descname">sj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.sj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.sj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTF2SJEX.sjex">
<code class="descname">sjex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.sjex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.sjex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTF2SJEX.sjexpaths">
<code class="descname">sjexpaths</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTF2SJEX.sjexpaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTF2SJEX.sjexpaths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.convert.GTFWriter">
<em class="property">class </em><code class="descclassname">jgem.convert.</code><code class="descname">GTFWriter</code><span class="sig-paren">(</span><em>mg</em>, <em>se=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTFWriter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTFWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.convert.BEDWriter" title="jgem.convert.BEDWriter"><code class="xref py py-class docutils literal"><span class="pre">jgem.convert.BEDWriter</span></code></a></p>
<dl class="method">
<dt id="jgem.convert.GTFWriter.path2rec">
<code class="descname">path2rec</code><span class="sig-paren">(</span><em>exons</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTFWriter.path2rec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTFWriter.path2rec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.convert.GTFWriter.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#GTFWriter.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.GTFWriter.write" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="jgem.convert.bed2exonsj">
<code class="descclassname">jgem.convert.</code><code class="descname">bed2exonsj</code><span class="sig-paren">(</span><em>bed12</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#bed2exonsj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.bed2exonsj" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract exons and junctions from BED12</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bed12</strong> &#8211; Pandas.DataFrame containing BED12 data</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Pandas.DataFrames containing junction and exons</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">sj, ex</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.convert.gtf2exonsj">
<code class="descclassname">jgem.convert.</code><code class="descname">gtf2exonsj</code><span class="sig-paren">(</span><em>gtf</em>, <em>np=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#gtf2exonsj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.gtf2exonsj" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract exons and sj from GTF
exon, junction coordinates = zero based (same as BED)
junction start-1 = exon end
junction end = exon start</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>gtf</strong> &#8211; Pandas.DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Pandas.DataFrames for splice junctions and exons</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">sj, ex</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.convert.sjex2bed12">
<code class="descclassname">jgem.convert.</code><code class="descname">sjex2bed12</code><span class="sig-paren">(</span><em>sj</em>, <em>ex</em>, <em>dstpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/convert.html#sjex2bed12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.convert.sjex2bed12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jgem.evaluate">
<span id="evaluate-module"></span><h2>evaluate module<a class="headerlink" href="#module-jgem.evaluate" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-evaluate"></span><dl class="class">
<dt id="jgem.evaluate.EvalMatch">
<em class="property">class </em><code class="descclassname">jgem.evaluate.</code><code class="descname">EvalMatch</code><span class="sig-paren">(</span><em>en1</em>, <em>en2</em>, <em>bigwig</em>, <em>sjfile</em>, <em>datacode</em>, <em>binsize=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Compare two models against a genome coverage (bigwig)
and junction counts (sjfile).</p>
<dl class="docutils">
<dt>Usage:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">en1</span> <span class="o">=</span> <span class="n">EvalNames</span><span class="p">(</span><span class="n">sjexpre_to_ref</span><span class="p">,</span> <span class="s1">&#39;ref&#39;</span><span class="p">,</span> <span class="n">outdir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">en2</span> <span class="o">=</span> <span class="n">EvalNames</span><span class="p">(</span><span class="n">sjexpre_to_target</span><span class="p">,</span> <span class="s1">&#39;tgt&#39;</span><span class="p">,</span> <span class="n">outdir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">em</span> <span class="o">=</span> <span class="n">EvalMatch</span><span class="p">(</span><span class="n">en1</span><span class="p">,</span><span class="n">en2</span><span class="p">,</span><span class="n">bwfile</span><span class="p">,</span><span class="n">sjfile</span><span class="p">,</span><span class="n">datacode</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">figs</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>en1</strong> &#8211; EvalNames object, reference</li>
<li><strong>en2</strong> &#8211; EvalNames object, sensitivity of this model against en1 is calculated</li>
<li><strong>bigwig</strong> &#8211; path to normalized bigwig coverage file</li>
<li><strong>sjfile</strong> &#8211; path to normalized junction counts file</li>
<li><strong>datacode</strong> &#8211; code indicating data (bigwig &amp; sjfile)</li>
<li><strong>binsize</strong> (<em>int</em>) &#8211; for sensitivity plot (default 1000)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="jgem.evaluate.EvalMatch.abbr">
<code class="descname">abbr</code><em class="property"> = {'3b': &quot;3' exons (b)&quot;, '5': &quot;5' exons&quot;, '3': &quot;3' exons&quot;, 'sb': 'single exons (b)', 'i': 'internal exons', 'j': 'junctions', 's': 'single exons', '5b': &quot;5' exons (b)&quot;}</em><a class="headerlink" href="#jgem.evaluate.EvalMatch.abbr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.calc_completeness">
<code class="descname">calc_completeness</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.calc_completeness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.calc_completeness" title="Permalink to this definition">¶</a></dt>
<dd><p>Completeness measures how much of the reference gene structure is recovered.</p>
<ol class="arabic simple">
<li>GLC: gene length completeness = max(ratio of gene length covered by overlapping target gene)</li>
<li>ECC: exon count completeness = max(ratio of overlapping exon counts)</li>
<li>JCC: junction count completeness = max(ratio of overlapping junction counts)</li>
</ol>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.calc_stats">
<code class="descname">calc_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.calc_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.calc_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>np=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.calculate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate necessary data.</p>
<ol class="arabic simple">
<li>for en1 and en2 calculate ecov,gcov,jcnt (prep_sjex)</li>
<li>calculate match between en1 and en2 (find_match)</li>
<li>calculate length ratio, detected numbers, sensitivity, etc. (calc_stats)</li>
</ol>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.colname">
<code class="descname">colname</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.colname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.colname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.colname2">
<code class="descname">colname2</code><span class="sig-paren">(</span><em>x</em>, <em>code</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.colname2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.colname2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.find_match">
<code class="descname">find_match</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.find_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.find_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.get_detection_percentages">
<code class="descname">get_detection_percentages</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.get_detection_percentages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.get_detection_percentages" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a dataframe containing detection percentages.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.load">
<code class="descname">load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.plot_completeness">
<code class="descname">plot_completeness</code><span class="sig-paren">(</span><em>axr=None, tgts=['glc', 'ecc', 'jcc'], pw='dft', disp='both', title=None, xlim=[0, 10], xlimjcc=[0, 40], **kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.plot_completeness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.plot_completeness" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.plot_detection">
<code class="descname">plot_detection</code><span class="sig-paren">(</span><em>ax=None, w1=['i', '5', '3', 's', 'j'], w2=[0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.plot_detection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.plot_detection" title="Permalink to this definition">¶</a></dt>
<dd><p>Make bar graphs of detection percentages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Axes object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.plot_ratio">
<code class="descname">plot_ratio</code><span class="sig-paren">(</span><em>axr=None</em>, <em>plotxlabel=True</em>, <em>label=''</em>, <em>disp='both'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.plot_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.plot_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot length ratios of best matching exons</p>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.plot_sensitivity">
<code class="descname">plot_sensitivity</code><span class="sig-paren">(</span><em>color='b.-', ypos=0, xpos=0, axr=None, lineonly=False, ws=['i', ('5', '5b'), ('3', '3b'), ('s', 'sb'), 'j']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.plot_sensitivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.plot_sensitivity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.prep_sjex">
<code class="descname">prep_sjex</code><span class="sig-paren">(</span><em>en</em>, <em>np=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.prep_sjex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.prep_sjex" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign ecov, gcov, jcnt</p>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalMatch.save">
<code class="descname">save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalMatch.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalMatch.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.evaluate.EvalNames">
<em class="property">class </em><code class="descclassname">jgem.evaluate.</code><code class="descname">EvalNames</code><span class="sig-paren">(</span><em>sjexbase</em>, <em>code</em>, <em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.filenames.FileNamesBase" title="jgem.filenames.FileNamesBase"><code class="xref py py-class docutils literal"><span class="pre">jgem.filenames.FileNamesBase</span></code></a></p>
<p>Filename manager for evaluation process.</p>
<dl class="attribute">
<dt id="evaluate.EvalNames.sjexbase">
<code class="descname">sjexbase</code><a class="headerlink" href="#evaluate.EvalNames.sjexbase" title="Permalink to this definition">¶</a></dt>
<dd><p>path prefix to junction, exon files (*.sj.txt.gz and *.ex.txt.gz)</p>
</dd></dl>

<dl class="attribute">
<dt id="evaluate.EvalNames.code">
<code class="descname">code</code><a class="headerlink" href="#evaluate.EvalNames.code" title="Permalink to this definition">¶</a></dt>
<dd><p>assembly identifier</p>
</dd></dl>

<dl class="attribute">
<dt id="evaluate.EvalNames.outdir">
<code class="descname">outdir</code><a class="headerlink" href="#evaluate.EvalNames.outdir" title="Permalink to this definition">¶</a></dt>
<dd><p>output directory</p>
</dd></dl>

<p>All outputs and temporary files are prefixed by <strong>outdir/code</strong></p>
<dl class="method">
<dt id="jgem.evaluate.EvalNames.fname2">
<code class="descname">fname2</code><span class="sig-paren">(</span><em>suffix</em>, <em>code2</em>, <em>category='temp'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalNames.fname2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalNames.fname2" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate filenames furthre prefixed by code2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>suffix</strong> &#8211; (str)</li>
<li><strong>code2</strong> &#8211; (str) identifier (comparison target)</li>
<li><strong>category</strong> &#8211; (str)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(outdir)/(code).(code2).(suffix)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalNames.model">
<code class="descname">model</code><span class="sig-paren">(</span><em>which</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalNames.model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalNames.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns model dataframe (junction/exon/chopped intervals).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>which</strong> &#8211; one of &#8216;sj&#8217;,&#8217;ex&#8217;, &#8216;ci&#8217;</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalNames.modelpath">
<code class="descname">modelpath</code><span class="sig-paren">(</span><em>which</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalNames.modelpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalNames.modelpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns path to junction(sj)/exon(ex)/choppedinterval(ci) file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>which</strong> &#8211; one of &#8216;sj&#8217;,&#8217;ex&#8217;,&#8217;ci&#8217;</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jgem.evaluate.EvalNames.savemodel">
<code class="descname">savemodel</code><span class="sig-paren">(</span><em>which</em>, <em>code2=None</em>, <em>category='temp'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/evaluate.html#EvalNames.savemodel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.evaluate.EvalNames.savemodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model. If code2 is None, overwrite original, if code2 is provided,
writes to outdir/(code).(code2).(which).txt.gz.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>which</strong> &#8211; &#8216;sj&#8217;,&#8217;ex&#8217;,&#8217;ci&#8217;</li>
<li><strong>code2</strong> &#8211; 2nd identifier</li>
<li><strong>category</strong> &#8211; filename category (default &#8216;temp&#8217;)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">file path or None (if model is not loaded)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jgem.filenames">
<span id="filenames-module"></span><h2>filenames module<a class="headerlink" href="#module-jgem.filenames" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-filenlames"></span><dl class="class">
<dt id="jgem.filenames.FileNames">
<em class="property">class </em><code class="descclassname">jgem.filenames.</code><code class="descname">FileNames</code><span class="sig-paren">(</span><em>sname</em>, <em>bwfile</em>, <em>sjfile</em>, <em>outdir</em>, <em>refgtf='.gtf'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.filenames.FileNamesBase" title="jgem.filenames.FileNamesBase"><code class="xref py py-class docutils literal"><span class="pre">jgem.filenames.FileNamesBase</span></code></a></p>
<p>Filenames for the Assembler.</p>
<p>Holds
- sample name (sname)
- bigwig coverage file path (bwfile)
- junction file path (sjfile)
- output directory (outdir)
- reference (refgtf) if using it for finding SE (single exon) coverage threshold</p>
<p>All filenames have <strong>outdir+sname</strong> as prefix.</p>
<p>Handles filenames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sname</strong> (<em>str</em>) &#8211; sample name</li>
<li><strong>bwfile</strong> (<em>str</em>) &#8211; path to normalized coverage bigwig file</li>
<li><strong>sjfile</strong> (<em>str</em>) &#8211; path to junction file</li>
<li><strong>outdir</strong> (<em>str</em>) &#8211; path to output directory</li>
<li><strong>refgtf</strong> (<em>str</em>) &#8211; (optional) path to reference GTF</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="jgem.filenames.FileNames.bedname2">
<code class="descname">bedname2</code><span class="sig-paren">(</span><em>suf</em>, <em>th</em>, <em>cat='temp'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNames.bedname2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNames.bedname2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNames.ex_out">
<code class="descname">ex_out</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNames.ex_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNames.ex_out" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNames.genes_out">
<code class="descname">genes_out</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNames.genes_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNames.genes_out" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNames.refname">
<code class="descname">refname</code><span class="sig-paren">(</span><em>suf</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNames.refname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNames.refname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNames.refsjex">
<code class="descname">refsjex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNames.refsjex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNames.refsjex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNames.sj_out">
<code class="descname">sj_out</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNames.sj_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNames.sj_out" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.filenames.FileNamesBase">
<em class="property">class </em><code class="descclassname">jgem.filenames.</code><code class="descname">FileNamesBase</code><span class="sig-paren">(</span><em>prefix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base calss for handling tons of (temporary) filenames.
* All filenames have a common prefix.
* Each filename belong to a category.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prefix</strong> (<em>str</em>) &#8211; path prefix</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="jgem.filenames.FileNamesBase.bedname">
<code class="descname">bedname</code><span class="sig-paren">(</span><em>suffix</em>, <em>category='temp'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.bedname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.bedname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNamesBase.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><em>delete=['temp'], protect=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete temporary files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>delete</strong> (<em>list</em>) &#8211; categories to delete default [&#8216;temp&#8217;]</li>
<li><strong>protect</strong> (<em>list</em>) &#8211; output categories (files in these cateogries
are protpected)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNamesBase.delete_prefixed">
<code class="descname">delete_prefixed</code><span class="sig-paren">(</span><em>suffix=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.delete_prefixed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.delete_prefixed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNamesBase.fname">
<code class="descname">fname</code><span class="sig-paren">(</span><em>suffix</em>, <em>category='temp'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.fname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.fname" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a filename (path).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>suffix</strong> &#8211; (str)</li>
<li><strong>category</strong> &#8211; (str) default &#8216;temp&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(prefix).(suffix)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNamesBase.read_bed">
<code class="descname">read_bed</code><span class="sig-paren">(</span><em>suffix</em>, <em>category='read'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.read_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.read_bed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNamesBase.read_txt">
<code class="descname">read_txt</code><span class="sig-paren">(</span><em>suffix</em>, <em>category='read'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.read_txt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.read_txt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNamesBase.txtname">
<code class="descname">txtname</code><span class="sig-paren">(</span><em>suffix</em>, <em>category='temp'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.txtname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.txtname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNamesBase.write_bed">
<code class="descname">write_bed</code><span class="sig-paren">(</span><em>df</em>, <em>suffix</em>, <em>ncols</em>, <em>category='temp'</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.write_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.write_bed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.filenames.FileNamesBase.write_txt">
<code class="descname">write_txt</code><span class="sig-paren">(</span><em>df</em>, <em>suffix</em>, <em>fm='h'</em>, <em>category='temp'</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/filenames.html#FileNamesBase.write_txt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.filenames.FileNamesBase.write_txt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jgem.graph">
<span id="graph-module"></span><h2>graph module<a class="headerlink" href="#module-jgem.graph" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-graph"></span><dl class="class">
<dt id="jgem.graph.MEGraph2">
<em class="property">class </em><code class="descclassname">jgem.graph.</code><code class="descname">MEGraph2</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>depth=500</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="jgem.graph.MEGraph2.allcomponents">
<code class="descname">allcomponents</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.allcomponents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.allcomponents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.allcomponents_nr">
<code class="descname">allcomponents_nr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.allcomponents_nr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.allcomponents_nr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.connected">
<code class="descname">connected</code><span class="sig-paren">(</span><em>eid</em>, <em>exx=None</em>, <em>depth=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.connected"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.connected" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.connected_nr">
<code class="descname">connected_nr</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.connected_nr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.connected_nr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.consistent">
<code class="descname">consistent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.consistent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.consistent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.ex_ex">
<code class="descname">ex_ex</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.ex_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.ex_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.ex_l_ex">
<code class="descname">ex_l_ex</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.ex_l_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.ex_l_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.ex_r_ex">
<code class="descname">ex_r_ex</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.ex_r_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.ex_r_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.sj_ex">
<code class="descname">sj_ex</code><span class="sig-paren">(</span><em>sjrec, flds=['strand']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.sj_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.sj_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.sj_leftex">
<code class="descname">sj_leftex</code><span class="sig-paren">(</span><em>st_id, flds=['st', 'name']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.sj_leftex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.sj_leftex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph2.sj_rightex">
<code class="descname">sj_rightex</code><span class="sig-paren">(</span><em>ed_id, flds=['ed', 'name']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph2.sj_rightex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph2.sj_rightex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.graph.MEGraph3">
<em class="property">class </em><code class="descclassname">jgem.graph.</code><code class="descname">MEGraph3</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>depth=500</em>, <em>maxcnt=990</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>acceptor/donor version, has problem if there&#8217;s unstranded data</p>
<dl class="method">
<dt id="jgem.graph.MEGraph3.allcomponents">
<code class="descname">allcomponents</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.allcomponents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.allcomponents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.allcomponents_nr">
<code class="descname">allcomponents_nr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.allcomponents_nr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.allcomponents_nr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.connected">
<code class="descname">connected</code><span class="sig-paren">(</span><em>eid</em>, <em>depth=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.connected"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.connected" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.connected_nr">
<code class="descname">connected_nr</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.connected_nr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.connected_nr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.consistent">
<code class="descname">consistent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.consistent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.consistent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.ex_a_ex">
<code class="descname">ex_a_ex</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.ex_a_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.ex_a_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.ex_d_ex">
<code class="descname">ex_d_ex</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.ex_d_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.ex_d_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.ex_ex">
<code class="descname">ex_ex</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.ex_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.ex_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.sj_leftex">
<code class="descname">sj_leftex</code><span class="sig-paren">(</span><em>aid</em>, <em>did</em>, <em>strand</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.sj_leftex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.sj_leftex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.graph.MEGraph3.sj_rightex">
<code class="descname">sj_rightex</code><span class="sig-paren">(</span><em>aid</em>, <em>did</em>, <em>strand</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph3.sj_rightex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph3.sj_rightex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.graph.MEGraph4">
<em class="property">class </em><code class="descclassname">jgem.graph.</code><code class="descname">MEGraph4</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>filepre</em>, <em>depth=500</em>, <em>maxcnt=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.graph.MEGraph3" title="jgem.graph.MEGraph3"><code class="xref py py-class docutils literal"><span class="pre">jgem.graph.MEGraph3</span></code></a></p>
<dl class="method">
<dt id="jgem.graph.MEGraph4.ex_ex">
<code class="descname">ex_ex</code><span class="sig-paren">(</span><em>eid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#MEGraph4.ex_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.MEGraph4.ex_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="jgem.graph.find_genes3">
<code class="descclassname">jgem.graph.</code><code class="descname">find_genes3</code><span class="sig-paren">(</span><em>sj</em>, <em>ae</em>, <em>cachename=None</em>, <em>np=1</em>, <em>override=False</em>, <em>depth=140</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#find_genes3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.find_genes3" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds _gidx column to ae
Connection: by junctions</p>
<p>Returns genes [set([_id,..]), ...]</p>
</dd></dl>

<dl class="function">
<dt id="jgem.graph.find_genes4">
<code class="descclassname">jgem.graph.</code><code class="descname">find_genes4</code><span class="sig-paren">(</span><em>sj</em>, <em>ae</em>, <em>filepre</em>, <em>cachename=None</em>, <em>np=1</em>, <em>override=False</em>, <em>depth=500</em>, <em>separatese=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#find_genes4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.find_genes4" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds _gidx column to ae
Connection: 1) by junctions, 2) by overlap in the same strand</p>
<p>Returns genes [set([_id,..]), ...]</p>
</dd></dl>

<dl class="function">
<dt id="jgem.graph.mcore_allcomponents">
<code class="descclassname">jgem.graph.</code><code class="descname">mcore_allcomponents</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>np=4</em>, <em>version=3</em>, <em>depth=500</em>, <em>maxcnt=10000</em>, <em>chroms=None</em>, <em>filepre=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#mcore_allcomponents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.mcore_allcomponents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.graph.mcore_allcomponents2">
<code class="descclassname">jgem.graph.</code><code class="descname">mcore_allcomponents2</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>np=4</em>, <em>depth=500</em>, <em>maxcnt=10000</em>, <em>chroms=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#mcore_allcomponents2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.mcore_allcomponents2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.graph.mcore_allcomponents3">
<code class="descclassname">jgem.graph.</code><code class="descname">mcore_allcomponents3</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>np=4</em>, <em>depth=500</em>, <em>maxcnt=10000</em>, <em>chroms=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#mcore_allcomponents3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.mcore_allcomponents3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.graph.mcore_allcomponents4">
<code class="descclassname">jgem.graph.</code><code class="descname">mcore_allcomponents4</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em>, <em>filepre</em>, <em>np=4</em>, <em>depth=500</em>, <em>maxcnt=10000</em>, <em>chroms=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#mcore_allcomponents4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.mcore_allcomponents4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.graph.worker">
<code class="descclassname">jgem.graph.</code><code class="descname">worker</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/graph.html#worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.graph.worker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jgem.gtfgffbed">
<span id="gtfgffbed-module"></span><h2>gtfgffbed module<a class="headerlink" href="#module-jgem.gtfgffbed" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-gtfgffbed"></span><dl class="function">
<dt id="jgem.gtfgffbed.bed2gtf">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">bed2gtf</code><span class="sig-paren">(</span><em>fpath</em>, <em>compress=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#bed2gtf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.bed2gtf" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert BED to GTF. Uses bedToGenePred, genePredToGtf (UCSC Kent Tools)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gtfname</strong> &#8211; path to BED file</li>
<li><strong>compress</strong> &#8211; whether to gzip (default True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas.DataFrame containing converted GTF data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.chop_chrs_gtf">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">chop_chrs_gtf</code><span class="sig-paren">(</span><em>gtfname</em>, <em>chrs</em>, <em>outdir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#chop_chrs_gtf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.chop_chrs_gtf" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate chromosomes into different files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>gtfname</strong> &#8211; path to GTF</li>
<li><strong>chrs</strong> &#8211; list of chromosome names</li>
<li><strong>outdir</strong> &#8211; output directory, if None (default), then use same directory as input</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.fasta2panda">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">fasta2panda</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#fasta2panda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.fasta2panda" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.get_gff_attr_col">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">get_gff_attr_col</code><span class="sig-paren">(</span><em>gff</em>, <em>aname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#get_gff_attr_col"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.get_gff_attr_col" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function for read_gff</p>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.get_gtf_attr_col">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">get_gtf_attr_col</code><span class="sig-paren">(</span><em>gtf</em>, <em>aname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#get_gtf_attr_col"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.get_gtf_attr_col" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function for read_gtf</p>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.gtf2bed12">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">gtf2bed12</code><span class="sig-paren">(</span><em>fpath</em>, <em>compress=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#gtf2bed12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.gtf2bed12" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert GTF to BED. Uses gtfToGenePred, genePredToBed (UCSC Kent Tools)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gtfname</strong> &#8211; path to GTF file</li>
<li><strong>compress</strong> &#8211; whether to gzip (default True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas.DataFrame containing converted BED12 data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.gtf2gff">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">gtf2gff</code><span class="sig-paren">(</span><em>gtfname</em>, <em>gffname</em>, <em>memt=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#gtf2gff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.gtf2gff" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert GTF to GFF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gtfname</strong> &#8211; path to GTF file</li>
<li><strong>gffname</strong> &#8211; path for converted GFF file</li>
<li><strong>memt</strong> &#8211; only select multiexon, multitranscript</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas.DataFrame containing converted GFF data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.read_bed">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">read_bed</code><span class="sig-paren">(</span><em>fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#read_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.read_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Read BED file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fpath</strong> &#8211; path to BED file (no header)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Pandas DataFrame containing BED data</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.read_gff">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">read_gff</code><span class="sig-paren">(</span><em>gffname</em>, <em>onlytypes=[]</em>, <em>parseattrs=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#read_gff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.read_gff" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in whole GFF, parse id &amp; parent</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gffname</strong> &#8211; path to GFF file</li>
<li><strong>onlytypes</strong> &#8211; only keep these types. If [] or None, then keep all (default).</li>
<li><strong>parseattrs</strong> &#8211; extra attributes to parse</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas.DataFrame containing GFF data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.read_gtf">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">read_gtf</code><span class="sig-paren">(</span><em>gtfname, onlytypes=[], parseattrs=['gene_id', 'transcript_id', 'exon_number', 'gene_name', 'cov', 'FPKM'], rename={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#read_gtf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.read_gtf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in whole GTF, parse gene_id, transcript_id from column 9</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gtfname</strong> &#8211; path to GTF file</li>
<li><strong>onlytypes</strong> &#8211; only keep these types. If [] or None, then keep all (default).</li>
<li><strong>parseattrs</strong> &#8211; which column attributes to parse.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas DataFrame containing GTF data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.read_gtf0">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">read_gtf0</code><span class="sig-paren">(</span><em>gtfname, onlytypes=[], parseattrs=['gene_id', 'transcript_id', 'exon_number', 'gene_name', 'cov', 'FPKM'], rename={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#read_gtf0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.read_gtf0" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in whole GTF, parse gene_id, transcript_id from column 9</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gtfname</strong> &#8211; path to GTF file</li>
<li><strong>onlytypes</strong> &#8211; only keep these types. If [] or None, then keep all (default).</li>
<li><strong>parseattrs</strong> &#8211; which column attributes to parse.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas DataFrame containing GTF data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.read_gtf1">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">read_gtf1</code><span class="sig-paren">(</span><em>gtfname, onlytypes=[], parseattrs=['gene_id', 'transcript_id', 'exon_number', 'gene_name', 'cov', 'FPKM'], rename={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#read_gtf1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.read_gtf1" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in whole GTF, parse gene_id, transcript_id from column 9</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gtfname</strong> &#8211; path to GTF file</li>
<li><strong>onlytypes</strong> &#8211; only keep these types. If [] or None, then keep all (default).</li>
<li><strong>parseattrs</strong> &#8211; which column attributes to parse.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas DataFrame containing GTF data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.read_sj">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">read_sj</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#read_sj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.read_sj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.sjtab2sjbed">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">sjtab2sjbed</code><span class="sig-paren">(</span><em>sjtab</em>, <em>sjbed</em>, <em>scale=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#sjtab2sjbed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.sjtab2sjbed" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate splice junction input file from STAR SJ.out.tab</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sjtab</strong> (<em>str</em>) &#8211; path to SJ.out.tab file</li>
<li><strong>sjbed</strong> (<em>str</em>) &#8211; path to output bed</li>
<li><strong>scale</strong> (<em>float</em>) &#8211; a number to multiply (default None, no change)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas dataframe</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.write_bed">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">write_bed</code><span class="sig-paren">(</span><em>df</em>, <em>fname</em>, <em>compress=True</em>, <em>ncols=6</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#write_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.write_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Write BED file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas.DataFrame containing BED data</li>
<li><strong>fname</strong> &#8211; path</li>
<li><strong>compress</strong> &#8211; whether to gzip compress (default:True)</li>
<li><strong>ncols</strong> &#8211; number of bed columns (default 12)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">actual path written</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.write_gff">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">write_gff</code><span class="sig-paren">(</span><em>df</em>, <em>fname</em>, <em>compress=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#write_gff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.write_gff" title="Permalink to this definition">¶</a></dt>
<dd><p>Write GFF file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas.DataFrame containing GFF data</li>
<li><strong>fname</strong> &#8211; path</li>
<li><strong>compress</strong> &#8211; whether to gzip compress (default:True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">actual path written</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.write_ggb">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">write_ggb</code><span class="sig-paren">(</span><em>df</em>, <em>fname</em>, <em>cols</em>, <em>compress=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#write_ggb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.write_ggb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.gtfgffbed.write_gtf">
<code class="descclassname">jgem.gtfgffbed.</code><code class="descname">write_gtf</code><span class="sig-paren">(</span><em>df</em>, <em>fname</em>, <em>compress=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/gtfgffbed.html#write_gtf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.gtfgffbed.write_gtf" title="Permalink to this definition">¶</a></dt>
<dd><p>Write GTF file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas.DataFrame containing GTF data</li>
<li><strong>fname</strong> &#8211; path</li>
<li><strong>compress</strong> &#8211; whether to gzip compress (default:True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">actual path written</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-jgem.merge">
<span id="merge-module"></span><h2>merge module<a class="headerlink" href="#module-jgem.merge" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-merge"></span><dl class="class">
<dt id="jgem.merge.MergeAssemble">
<em class="property">class </em><code class="descclassname">jgem.merge.</code><code class="descname">MergeAssemble</code><span class="sig-paren">(</span><em>fni</em>, <em>fna</em>, <em>saveintermediates=False</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Merge multiple assemblies into one.</p>
<ol class="arabic simple">
<li>run assembler for each strand</li>
<li>combine outputs from each strand (ME: multi-exons)</li>
<li>detect SE (single-exons)</li>
<li>combine ME and SE</li>
<li>calculate coverage based on averaged bigwig</li>
<li>calculate junction coverage based on aggregated junctions</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fni</strong> &#8211; MergeInputNames object</li>
<li><strong>fna</strong> &#8211; MergeAssemblyNames object</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Keywords:</dt>
<dd>can be used to modify assembly parameters</dd>
</dl>
<dl class="method">
<dt id="jgem.merge.MergeAssemble.assemble">
<code class="descname">assemble</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.assemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.assemble" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemble.assemble_combine">
<code class="descname">assemble_combine</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.assemble_combine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.assemble_combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine ME/SE</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemble.assemble_me1">
<code class="descname">assemble_me1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.assemble_me1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.assemble_me1" title="Permalink to this definition">¶</a></dt>
<dd><p>do assembly separately for each strand</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemble.assemble_me2">
<code class="descname">assemble_me2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.assemble_me2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.assemble_me2" title="Permalink to this definition">¶</a></dt>
<dd><p>combine strands for ME</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemble.assemble_se">
<code class="descname">assemble_se</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.assemble_se"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.assemble_se" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate SE candidate (subtract ME)
Currently only filter with maxcov.</p>
<p>This part needs to be improved.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemble.assemble_writefiles">
<code class="descname">assemble_writefiles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.assemble_writefiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.assemble_writefiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Write EX, SJ, GENES output files</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemble.assign_sjcnt">
<code class="descname">assign_sjcnt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.assign_sjcnt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.assign_sjcnt" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate junction counts</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemble.calc_merged_covs">
<code class="descname">calc_merged_covs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.calc_merged_covs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.calc_merged_covs" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate ecov, gcov against aggregated bigwig</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemble.make_assemblers">
<code class="descname">make_assemblers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemble.make_assemblers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemble.make_assemblers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.merge.MergeAssemblyNames">
<em class="property">class </em><code class="descclassname">jgem.merge.</code><code class="descname">MergeAssemblyNames</code><span class="sig-paren">(</span><em>code</em>, <em>outdir</em>, <em>refgtf='.gtf'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemblyNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemblyNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.filenames.FileNamesBase" title="jgem.filenames.FileNamesBase"><code class="xref py py-class docutils literal"><span class="pre">jgem.filenames.FileNamesBase</span></code></a></p>
<p>Filelname manager for the assembling part of the merging process.</p>
<dl class="attribute">
<dt id="merge.MergeAssemblyNames.code">
<code class="descname">code</code><a class="headerlink" href="#merge.MergeAssemblyNames.code" title="Permalink to this definition">¶</a></dt>
<dd><p>merge identifier (for merge input generation part)</p>
</dd></dl>

<dl class="attribute">
<dt id="merge.MergeAssemblyNames.outdir">
<code class="descname">outdir</code><a class="headerlink" href="#merge.MergeAssemblyNames.outdir" title="Permalink to this definition">¶</a></dt>
<dd><p>output directory</p>
</dd></dl>

<dl class="attribute">
<dt id="merge.MergeAssemblyNames.refgtf">
<code class="descname">refgtf</code><a class="headerlink" href="#merge.MergeAssemblyNames.refgtf" title="Permalink to this definition">¶</a></dt>
<dd><p>reference gtf path if using it for finding SE cov threshold</p>
</dd></dl>

<p>All outputs and temporary files are prefixed by <strong>outdir/code</strong></p>
<dl class="method">
<dt id="jgem.merge.MergeAssemblyNames.ci_out">
<code class="descname">ci_out</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemblyNames.ci_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemblyNames.ci_out" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemblyNames.ex_out">
<code class="descname">ex_out</code><span class="sig-paren">(</span><em>ext='txt'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemblyNames.ex_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemblyNames.ex_out" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemblyNames.genes_out">
<code class="descname">genes_out</code><span class="sig-paren">(</span><em>ext='txt'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemblyNames.genes_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemblyNames.genes_out" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeAssemblyNames.sj_out">
<code class="descname">sj_out</code><span class="sig-paren">(</span><em>ext='txt'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeAssemblyNames.sj_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeAssemblyNames.sj_out" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.merge.MergeInputNames">
<em class="property">class </em><code class="descclassname">jgem.merge.</code><code class="descname">MergeInputNames</code><span class="sig-paren">(</span><em>sampleinfo</em>, <em>code</em>, <em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jgem.filenames.FileNamesBase" title="jgem.filenames.FileNamesBase"><code class="xref py py-class docutils literal"><span class="pre">jgem.filenames.FileNamesBase</span></code></a></p>
<p>Filelname manager for generating inputs for merging process.</p>
<dl class="attribute">
<dt id="merge.MergeInputNames.sampleinfo">
<code class="descname">sampleinfo</code><a class="headerlink" href="#merge.MergeInputNames.sampleinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>sample info dataframe (with columns: name, sjpath, expath, bwfile, sjfile)</p>
</dd></dl>

<dl class="attribute">
<dt id="merge.MergeInputNames.code">
<code class="descname">code</code><a class="headerlink" href="#merge.MergeInputNames.code" title="Permalink to this definition">¶</a></dt>
<dd><p>merge identifier (for merge input generation part)</p>
</dd></dl>

<dl class="attribute">
<dt id="merge.MergeInputNames.outdir">
<code class="descname">outdir</code><a class="headerlink" href="#merge.MergeInputNames.outdir" title="Permalink to this definition">¶</a></dt>
<dd><p>output directory</p>
</dd></dl>

<p>All outputs and temporary files are prefixed by <strong>outdir/code</strong></p>
<dl class="docutils">
<dt>SampleInfo Columns:</dt>
<dd>name: sample name (unique)
sjexpre: path prefix to SJ/EX files (sj.txt.gz, ex.txt.gz will be added)
bw_path: original bigwig coverage
sjbed_path: original junction bed file (converted from SJ.out.tab)</dd>
</dl>
<dl class="method">
<dt id="jgem.merge.MergeInputNames.agg_bw">
<code class="descname">agg_bw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.agg_bw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.agg_bw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.allsj_stats">
<code class="descname">allsj_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.allsj_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.allsj_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.allsj_txt">
<code class="descname">allsj_txt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.allsj_txt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.allsj_txt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.bwpaths">
<code class="descname">bwpaths</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.bwpaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.bwpaths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.ex_bed">
<code class="descname">ex_bed</code><span class="sig-paren">(</span><em>k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.ex_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.ex_bed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.ex_bw">
<code class="descname">ex_bw</code><span class="sig-paren">(</span><em>k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.ex_bw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.ex_bw" title="Permalink to this definition">¶</a></dt>
<dd><p>BW output, strand = p,n</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.expaths">
<code class="descname">expaths</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.expaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.expaths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.sj0_bed">
<code class="descname">sj0_bed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.sj0_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.sj0_bed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.sj2_txt">
<code class="descname">sj2_txt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.sj2_txt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.sj2_txt" title="Permalink to this definition">¶</a></dt>
<dd><p>intermediate output with selection parameters</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.sj_bed">
<code class="descname">sj_bed</code><span class="sig-paren">(</span><em>strand</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.sj_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.sj_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>SJ output, strand = p,n</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.sjopaths">
<code class="descname">sjopaths</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.sjopaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.sjopaths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.sjpaths">
<code class="descname">sjpaths</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.sjpaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.sjpaths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputNames.snames">
<code class="descname">snames</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputNames.snames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputNames.snames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="jgem.merge.MergeInputs">
<em class="property">class </em><code class="descclassname">jgem.merge.</code><code class="descname">MergeInputs</code><span class="sig-paren">(</span><em>fnobj</em>, <em>genome='mm10'</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Generates inputs to merge assembling. Creates multiple bigwig files and a junction file.
Multiple bigwig file are for exons in each strand and for single exons.</p>
<ol class="arabic simple">
<li>pepare 3 merged bigwigs (ME+/ME-/SE) from all assemblies</li>
<li>prepare an aggregated junction file</li>
<li>select junctions</li>
<li>calculate average bigwig from original bigwigs</li>
</ol>
<p>(Note: at 1. bigwigs are from exon model outputs from each assembly, at 4. bigwig is just an
average of all original bigiwigs which were inputs to each assembly.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fnobj</strong> &#8211; MergeInputNames object</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Other keywords arguments:</dt>
<dd><ul class="first last simple">
<li>genome: UCSC genome name</li>
<li>np: number of CPU to use</li>
<li>covth: only use exons with coverage &gt; covth (default 0)</li>
<li>covdelta: exon coverage quantization delta</li>
<li>uth: unique reads threshold for junctions (default 0)</li>
<li>mth: non-unique reads threshold for junctions (default 5)</li>
<li>th_ratio: threshold for selecting junctions by overlapping ratio
(default 0.001, i.e. if a junction&#8217;s read is less than 1/1000 of the sum of
all the reads of overlapping junctions then the junction is discarded)</li>
<li>th_detected: junctions need to be detected in more than this number of samples (default 2)
unless max junction reads across samples is larger than th_maxcnt2</li>
<li>th_maxcnt1: max junction reads across sample has to be larger than this (default 0.1)</li>
<li>th_maxcnt2: if max junction reads across samples is larger than this, ignore th_detected
(default 4)</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="jgem.merge.MergeInputs.aggregate_bigwigs">
<code class="descname">aggregate_bigwigs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs.aggregate_bigwigs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs.aggregate_bigwigs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputs.collect_sj">
<code class="descname">collect_sj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs.collect_sj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs.collect_sj" title="Permalink to this definition">¶</a></dt>
<dd><p>From aggregated junctions, collect original reads for each samples.</p>
<dl class="docutils">
<dt>Inputs:</dt>
<dd>Aggregated junction file (&#8216;sj0.bed.gz&#8217;)
Sample junction files (input to original assemblies ~ SJ.out.tab)</dd>
<dt>Outputs:</dt>
<dd>&#8216;allsj.txt.gz&#8217;</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputs.make_ex_bigwigs">
<code class="descname">make_ex_bigwigs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs.make_ex_bigwigs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs.make_ex_bigwigs" title="Permalink to this definition">¶</a></dt>
<dd><p>Make 5 bigwig files from assembly exon outputs by treating each exon as reads weighted by coverage.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputs.make_sj0_bed">
<code class="descname">make_sj0_bed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs.make_sj0_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs.make_sj0_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate all junctions in the samples. Ucnt, mcnt will be the sum over all samples.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputs.make_sj_bed">
<code class="descname">make_sj_bed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs.make_sj_bed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs.make_sj_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Make merged junction input file.</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputs.prepare">
<code class="descname">prepare</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs.prepare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare merged bigwig coverage files, merged junction files and aggregated bigwig file (average cov).</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputs.select_sj">
<code class="descname">select_sj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs.select_sj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs.select_sj" title="Permalink to this definition">¶</a></dt>
<dd><p>Select aggregated junctions according to several metrics</p>
</dd></dl>

<dl class="method">
<dt id="jgem.merge.MergeInputs.write_sj">
<code class="descname">write_sj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#MergeInputs.write_sj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.MergeInputs.write_sj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="jgem.merge.make_ex_bed_chr">
<code class="descclassname">jgem.merge.</code><code class="descname">make_ex_bed_chr</code><span class="sig-paren">(</span><em>expaths</em>, <em>dstpre</em>, <em>chrom</em>, <em>covth</em>, <em>covdelta</em>, <em>tgts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#make_ex_bed_chr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.make_ex_bed_chr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.merge.make_sj_bed_chr">
<code class="descclassname">jgem.merge.</code><code class="descname">make_sj_bed_chr</code><span class="sig-paren">(</span><em>sjpaths</em>, <em>dstpath</em>, <em>chrom</em>, <em>uth</em>, <em>mth</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/merge.html#make_sj_bed_chr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.merge.make_sj_bed_chr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jgem.trimex">
<span id="trimex-module"></span><h2>trimex module<a class="headerlink" href="#module-jgem.trimex" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-trimex"></span><dl class="function">
<dt id="jgem.trimex.trim_ex">
<code class="descclassname">jgem.trimex.</code><code class="descname">trim_ex</code><span class="sig-paren">(</span><em>expath</em>, <em>dstpath</em>, <em>dstcipath</em>, <em>length=1000</em>, <em>gidfld='_gidx'</em>, <em>np=7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/trimex.html#trim_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.trimex.trim_ex" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate trimmed version of genes for calculating coverage to avoid length bias.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expath</strong> (<em>str</em>) &#8211; path exon tsv</li>
<li><strong>dstpath</strong> (<em>str</em>) &#8211; path to trimmed exon</li>
<li><strong>dstcipath</strong> (<em>str</em>) &#8211; path to ci (chopped interval)</li>
<li><strong>length</strong> (<em>pos int</em>) &#8211; length to trim from 3&#8217; end in base pair (default 1000 bp)</li>
<li><strong>gidfld</strong> (<em>str</em>) &#8211; column name for gene id (default _gidx)</li>
<li><strong>np</strong> (<em>pos int</em>) &#8211; number of CPU to use</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Generates:</dt>
<dd>Two files (dstpath, dstcipath).</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a dataframe containing trimmed exons</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.trimex.trim_ex_worker">
<code class="descclassname">jgem.trimex.</code><code class="descname">trim_ex_worker</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/trimex.html#trim_ex_worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.trimex.trim_ex_worker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jgem.utils">
<span id="utils-module"></span><h2>utils module<a class="headerlink" href="#module-jgem.utils" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-utils"></span><dl class="function">
<dt id="jgem.utils.calc_binned">
<code class="descclassname">jgem.utils.</code><code class="descname">calc_binned</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>num=500</em>, <em>yth=0</em>, <em>returnsorted=False</em>, <em>returnminmax=False</em>, <em>method='mean'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#calc_binned"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.calc_binned" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.calc_binned_percentile">
<code class="descclassname">jgem.utils.</code><code class="descname">calc_binned_percentile</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>percent=99</em>, <em>minbinw=0.25</em>, <em>minnum=500</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#calc_binned_percentile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.calc_binned_percentile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.calc_locus">
<code class="descclassname">jgem.utils.</code><code class="descname">calc_locus</code><span class="sig-paren">(</span><em>df</em>, <em>chrfld='chr'</em>, <em>stfld='st'</em>, <em>edfld='ed'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#calc_locus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.calc_locus" title="Permalink to this definition">¶</a></dt>
<dd><p>Create locus (chr*:start-end).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas.DataFrame</li>
<li><strong>chrfld</strong> (<em>str</em>) &#8211; field (column name) for chromosome</li>
<li><strong>stfld</strong> (<em>str</em>) &#8211; field (column name) for start position</li>
<li><strong>edfld</strong> (<em>str</em>) &#8211; field (column name) for end position</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas.Series</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.calc_locus_strand">
<code class="descclassname">jgem.utils.</code><code class="descname">calc_locus_strand</code><span class="sig-paren">(</span><em>df</em>, <em>chrfld='chr'</em>, <em>stfld='st'</em>, <em>edfld='ed'</em>, <em>strandfld='strand'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#calc_locus_strand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.calc_locus_strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Create locus with strand (chr*:start-end:+ or -).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas.DataFrame</li>
<li><strong>chrfld</strong> (<em>str</em>) &#8211; field (column name) for chromosome</li>
<li><strong>stfld</strong> (<em>str</em>) &#8211; field (column name) for start position</li>
<li><strong>edfld</strong> (<em>str</em>) &#8211; field (column name) for end position</li>
<li><strong>strandfld</strong> (<em>str</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Pandas.Series</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.calc_tlen">
<code class="descclassname">jgem.utils.</code><code class="descname">calc_tlen</code><span class="sig-paren">(</span><em>ex</em>, <em>ci</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#calc_tlen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.calc_tlen" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate gene transcript length, here just union of exons</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.chopintervals">
<code class="descclassname">jgem.utils.</code><code class="descname">chopintervals</code><span class="sig-paren">(</span><em>exons</em>, <em>fname=None</em>, <em>sort=True</em>, <em>idcol='_id'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#chopintervals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.chopintervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate into intervals where overlaps are constant over each interval.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>exons</strong> &#8211; DataFrame containing exons</li>
<li><strong>fname</strong> (<em>str</em>) &#8211; (optional) save results into this file</li>
<li><strong>sort</strong> (<em>bool</em>) &#8211; whether to sort the DataFrame</li>
<li><strong>idcol</strong> (<em>str</em>) &#8211; column name to use for id</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A DataFrame containing chopped intervals</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.chromdf">
<code class="descclassname">jgem.utils.</code><code class="descname">chromdf</code><span class="sig-paren">(</span><em>genome</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#chromdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.chromdf" title="Permalink to this definition">¶</a></dt>
<dd><p>returns chromosome size dataframe</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.chroms">
<code class="descclassname">jgem.utils.</code><code class="descname">chroms</code><span class="sig-paren">(</span><em>genome</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#chroms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.chroms" title="Permalink to this definition">¶</a></dt>
<dd><p>returns chromosome names</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.chromsizes">
<code class="descclassname">jgem.utils.</code><code class="descname">chromsizes</code><span class="sig-paren">(</span><em>genome</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#chromsizes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.chromsizes" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the path to chrom.sizes file</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.compress">
<code class="descclassname">jgem.utils.</code><code class="descname">compress</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#compress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.compress" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses gzip to compress file</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.df2dict">
<code class="descclassname">jgem.utils.</code><code class="descname">df2dict</code><span class="sig-paren">(</span><em>df</em>, <em>f1</em>, <em>f2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#df2dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.df2dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make dict from Pandas.DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; DataFrame</li>
<li><strong>f1</strong> &#8211; column for key</li>
<li><strong>f2</strong> &#8211; column for value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.exid">
<code class="descclassname">jgem.utils.</code><code class="descname">exid</code><span class="sig-paren">(</span><em>ex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#exid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.exid" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate exon id (chr:st-ed:strand)</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.find_nullidx">
<code class="descclassname">jgem.utils.</code><code class="descname">find_nullidx</code><span class="sig-paren">(</span><em>ex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#find_nullidx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.find_nullidx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.fit_sigmoid">
<code class="descclassname">jgem.utils.</code><code class="descname">fit_sigmoid</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>xlim=(0</em>, <em>7)</em>, <em>yth=0.99</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#fit_sigmoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.fit_sigmoid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.flattendf">
<code class="descclassname">jgem.utils.</code><code class="descname">flattendf</code><span class="sig-paren">(</span><em>df</em>, <em>col</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#flattendf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.flattendf" title="Permalink to this definition">¶</a></dt>
<dd><p>Flattens a column whose elements are lists. One row gets expanded into multiple rows,
each row containing a value from the list. All other columns in the expanded rows are the
same as the original row.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df</strong> &#8211; DataFrame</li>
<li><strong>col</strong> &#8211; target column which contains lists</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.grouper">
<code class="descclassname">jgem.utils.</code><code class="descname">grouper</code><span class="sig-paren">(</span><em>iterable</em>, <em>n</em>, <em>fill=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#grouper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.grouper" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect data into fixed-length chunks or blocks</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.invsig">
<code class="descclassname">jgem.utils.</code><code class="descname">invsig</code><span class="sig-paren">(</span><em>y</em>, <em>x0</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#invsig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.invsig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.isstring">
<code class="descclassname">jgem.utils.</code><code class="descname">isstring</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#isstring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.isstring" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.izipcols">
<code class="descclassname">jgem.utils.</code><code class="descname">izipcols</code><span class="sig-paren">(</span><em>df</em>, <em>cols</em>, <em>index=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#izipcols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.izipcols" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator to go through rows of Pandas.DataFrame
(Much faster than DataFrame.rows() which involves instantiation of Series objects)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df</strong> &#8211; DataFrame</li>
<li><strong>cols</strong> &#8211; list of column names</li>
<li><strong>index</strong> &#8211; if True, includue index at the beginning (default False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.makedirs">
<code class="descclassname">jgem.utils.</code><code class="descname">makedirs</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#makedirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.makedirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Make all the directories along the path, calls os.makedirs but
intercept irrelevant exceptions</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.me_se">
<code class="descclassname">jgem.utils.</code><code class="descname">me_se</code><span class="sig-paren">(</span><em>ex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#me_se"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.me_se" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate exons into multi-exons and single-exons</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.mese">
<code class="descclassname">jgem.utils.</code><code class="descname">mese</code><span class="sig-paren">(</span><em>ex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#mese"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.mese" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.mp_worker">
<code class="descclassname">jgem.utils.</code><code class="descname">mp_worker</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#mp_worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.mp_worker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.notstale">
<code class="descclassname">jgem.utils.</code><code class="descname">notstale</code><span class="sig-paren">(</span><em>opath</em>, <em>dpath</em>, <em>override=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#notstale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.notstale" title="Permalink to this definition">¶</a></dt>
<dd><p>Check dpath exists and newer than opath.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>opath</strong> (<em>str or list</em>) &#8211; dependency file(s)</li>
<li><strong>dpath</strong> (<em>str</em>) &#8211; cache file</li>
<li><strong>override</strong> (<em>bool</em>) &#8211; if True always return False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">whether dpath exists and newer than all of opath</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.process_mp">
<code class="descclassname">jgem.utils.</code><code class="descname">process_mp</code><span class="sig-paren">(</span><em>func</em>, <em>args</em>, <em>np</em>, <em>doreduce=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#process_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.process_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.read_pandas">
<code class="descclassname">jgem.utils.</code><code class="descname">read_pandas</code><span class="sig-paren">(</span><em>path</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#read_pandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.read_pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Read tab separated file into Pandas DataFrame.
Automatically recognize gzip compressed or uncompressed files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>str</em>) &#8211; path to the file</li>
<li><strong>kwargs</strong> &#8211; keyward arguments to pass to Pandas.read_table</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.remove_ercc">
<code class="descclassname">jgem.utils.</code><code class="descname">remove_ercc</code><span class="sig-paren">(</span><em>srcfile</em>, <em>dstfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#remove_ercc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.remove_ercc" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes ERCC portion of the data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>srcfile</strong> &#8211; source (GTF, GFF or BED)</li>
<li><strong>dstfile</strong> &#8211; destination</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.save_tsv">
<code class="descclassname">jgem.utils.</code><code class="descname">save_tsv</code><span class="sig-paren">(</span><em>df</em>, <em>path</em>, <em>gzip=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#save_tsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.save_tsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Write tab separated file. (Write index and header)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas DataFrame</li>
<li><strong>path</strong> (<em>str</em>) &#8211; destination path</li>
<li><strong>gzip</strong> (<em>bool</em>) &#8211; whether to gzip compress or not (default True)</li>
<li><strong>kwargs</strong> &#8211; keyward arguments to be passed to Pandas.to_csv</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">saved file path</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.save_tsv_nidx_nhead">
<code class="descclassname">jgem.utils.</code><code class="descname">save_tsv_nidx_nhead</code><span class="sig-paren">(</span><em>df</em>, <em>path</em>, <em>gzip=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#save_tsv_nidx_nhead"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.save_tsv_nidx_nhead" title="Permalink to this definition">¶</a></dt>
<dd><p>Write tab separated file. No index, no header.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas DataFrame</li>
<li><strong>path</strong> (<em>str</em>) &#8211; destination path</li>
<li><strong>gzip</strong> (<em>bool</em>) &#8211; whether to gzip compress or not (default True)</li>
<li><strong>kwargs</strong> &#8211; keyward arguments to be passed to Pandas.to_csv</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">saved file path</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.save_tsv_nidx_whead">
<code class="descclassname">jgem.utils.</code><code class="descname">save_tsv_nidx_whead</code><span class="sig-paren">(</span><em>df</em>, <em>path</em>, <em>gzip=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#save_tsv_nidx_whead"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.save_tsv_nidx_whead" title="Permalink to this definition">¶</a></dt>
<dd><p>Write tab separated file. No index, with header.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas DataFrame</li>
<li><strong>path</strong> (<em>str</em>) &#8211; destination path</li>
<li><strong>gzip</strong> (<em>bool</em>) &#8211; whether to gzip compress or not (default True)</li>
<li><strong>kwargs</strong> &#8211; keyward arguments to be passed to Pandas.to_csv</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">saved file path</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.series2dict">
<code class="descclassname">jgem.utils.</code><code class="descname">series2dict</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#series2dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.series2dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make dict from Pandas.Series</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.set_ad_info">
<code class="descclassname">jgem.utils.</code><code class="descname">set_ad_info</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#set_ad_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.set_ad_info" title="Permalink to this definition">¶</a></dt>
<dd><p>assign donor/acceptor id</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sj</strong> &#8211; splice junction DataFrame</li>
<li><strong>me</strong> &#8211; (multi-)exon DataFrame</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SideEffects:</dt>
<dd>add d_pos (donor position), a_pos (acceptor position), d_id, a_id,
d_degree, a_degree to sj and me</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.set_exon_category">
<code class="descclassname">jgem.utils.</code><code class="descname">set_exon_category</code><span class="sig-paren">(</span><em>sj</em>, <em>ex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#set_exon_category"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.set_exon_category" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.set_ids">
<code class="descclassname">jgem.utils.</code><code class="descname">set_ids</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#set_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.set_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>set &#8216;_id&#8217; field</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.set_info">
<code class="descclassname">jgem.utils.</code><code class="descname">set_info</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#set_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.set_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.set_pos_info">
<code class="descclassname">jgem.utils.</code><code class="descname">set_pos_info</code><span class="sig-paren">(</span><em>sj</em>, <em>me</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#set_pos_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.set_pos_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.set_ptyp">
<code class="descclassname">jgem.utils.</code><code class="descname">set_ptyp</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#set_ptyp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.set_ptyp" title="Permalink to this definition">¶</a></dt>
<dd><p>[Deprecated]
Set ptyp (exon type, internal 3prime, 5prime, single, etc.) according to exon name.</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.sigmoid">
<code class="descclassname">jgem.utils.</code><code class="descname">sigmoid</code><span class="sig-paren">(</span><em>x</em>, <em>x0</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#sigmoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.sigmoid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.sjid">
<code class="descclassname">jgem.utils.</code><code class="descname">sjid</code><span class="sig-paren">(</span><em>sj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#sjid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.sjid" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate junction id (chr:st^ed:strand)</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.today">
<code class="descclassname">jgem.utils.</code><code class="descname">today</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#today"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.today" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="jgem.utils.uncompress">
<code class="descclassname">jgem.utils.</code><code class="descname">uncompress</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#uncompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.uncompress" title="Permalink to this definition">¶</a></dt>
<dd><p>Unzip .gz file</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.uncompresscopy">
<code class="descclassname">jgem.utils.</code><code class="descname">uncompresscopy</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#uncompresscopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.uncompresscopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses unique file name to uncompress to avoid corruption in case of parallel computation.</p>
</dd></dl>

<dl class="function">
<dt id="jgem.utils.write_pandas">
<code class="descclassname">jgem.utils.</code><code class="descname">write_pandas</code><span class="sig-paren">(</span><em>df</em>, <em>path</em>, <em>fm='h'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jgem/utils.html#write_pandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jgem.utils.write_pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Write gzip compressed tab separated file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; Pandas DataFrame</li>
<li><strong>path</strong> (<em>str</em>) &#8211; destination path</li>
<li><strong>fm</strong> (<em>str</em>) &#8211; &#8216;i&#8217;:write index, &#8216;h&#8217;:write header, &#8216;ih&#8217;:write both index and header</li>
<li><strong>kwargs</strong> &#8211; keyward arguments to be passed to Pandas.to_csv</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">saved file path</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-jgem">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-jgem" title="Permalink to this headline">¶</a></h2>
<p>Copyright (c) 2015-2016 Ken Sugino</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Ken Sugino.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>